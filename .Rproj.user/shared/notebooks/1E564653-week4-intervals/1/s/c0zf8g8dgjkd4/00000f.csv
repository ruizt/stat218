"0","nsim <- 100"
"0","set.seed(13124)"
"0","intervals <- tibble(sim = 1:nsim, "
"0","                    pop.mean = mean(cholesterol)) %>%"
"0","  mutate(data = map(sim, ~sample(cholesterol, size = 50)),"
"0","         xbar = map(data, mean),"
"0","         se = map(data, ~sd(.x)/sqrt(length(.x)))) %>%"
"0","  unnest(cols = c(xbar, se)) %>%"
"0","  mutate(lwr = xbar - 2*se, "
"0","         upr = xbar + 2*se,"
"0","         coverage = factor((lwr < pop.mean)*(pop.mean < upr),"
"0","                           labels = c('misses', 'covers')))"
"0","         "
"0","         "
"0","intervals %>%"
"0","  ggplot(aes(x = xbar, y = sim, color = coverage)) +"
"0","  geom_point() +"
"0","  geom_linerange(aes(xmin = lwr, "
"0","                     xmax = upr)) +"
"0","  geom_vline(xintercept = mean(cholesterol),"
"0","             linetype = 'dashed') +"
"0","  theme_minimal(base_size = 20) +"
"0","  scale_x_continuous(breaks = round(mean(cholesterol) + sd(cholesterol)*c(-3, -1.5, 0, 1.5, 3)/sqrt(50), 2)) +"
"0","  theme(panel.grid = element_blank(),"
"0","        panel.grid.major.x = element_line(color = 'grey'),"
"0","        axis.text.y = element_blank(),"
"0","        legend.position = 'top') +"
"0","  labs(y = '', x = '') +"
"0","  guides(color = guide_legend(title = NULL))"
