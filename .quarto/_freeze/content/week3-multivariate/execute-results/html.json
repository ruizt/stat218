{
  "hash": "76628ef1eac850dbc5aa01649e9cd98c",
  "result": {
    "markdown": "---\ntitle: \"Bivariate summaries\"\nsubtitle: \"Quantitative and graphical techniques for summarizing two variables\"\nformat: \n  revealjs:\n    logo: img/poly-logo-2.jpg\n    footer: \"STAT218\"\n    smaller: true\n    mermaid:\n      theme: neutral\nexecute: \n  echo: false\n  warning: false\n  message: false\n---\n\n\n## Today's agenda\n\n\n::: {.cell}\n\n:::\n\n\n1.  HW discussion\n\n2.  Reading quiz \\[[2pm section](https://forms.office.com/r/BTsqQQLRqX)\\] \\[[4pm section](https://forms.office.com/r/GsSRY4e5VD)\\]\n\n3.  (Univariate) Measures of spread\n\n4.  Graphical summmaries for two variables\n\n    -   numeric/numeric\n    -   numeric/categorical\n    -   categorial/categorical\n\n5.  Lab: bivariate graphics in R\n\n## Measures of spread\n\nThe *spread* of observations refers to how concentrated or diffuse the values are.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](week3-multivariate_files/figure-revealjs/unnamed-chunk-2-1.png){fig-align='center' width=768}\n:::\n:::\n\n\nTwo ways to understand and measure spread:\n\n-   *ranges* of values capturing much of the distribution\n-   *deviations* of values from a central value\n\n## Range-based measures\n\nA simple way to understand and measure spread is based on ranges. Consider more ages, sorted and ranked:\n\n\n::: {.cell}\n::: {.cell-output-display}\n---------- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----\n **age**    16   18   19   20   21   22   25   26   28   29   30   34 \n\n **rank**   1    2    3    4    5    6    7    8    9    10   11   12 \n---------- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----\n:::\n:::\n\n\n-   The **range** is the difference \\[maximum value\\] - \\[minimum value\\] $$\\text{range} = 34 - 16 = 18$$\n\n-   The **interquartile range** (IQR) is the difference \\[75th percentile\\] - \\[25th percentile\\] $$\\text{IQR} = 29 - 19 = 10$$ *When might you prefer IQR to range? Can you think of an example?*\n\n## Deviation-based measures\n\nAnother way is based on *deviations* from a central value. Continuing the example, the mean age is is 24. The deviations of each observation from the mean are:\n\n\n::: {.cell}\n::: {.cell-output-display}\n--------------- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----\n    **age**      16   18   19   20   21   22   25   26   28   29   30   34 \n\n **deviation**   -8   -6   -5   -4   -3   -2   1    2    4    5    6    10 \n--------------- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----\n:::\n:::\n\n\nThe **average deviation** is defined as the average of the absolute values of the deviations from the mean: $$\\frac{8 + 6 + 5 + 4 + 3 + 2 + 1 + 2 + 4 + 5 + 6}{12}$$\n\nThe **standard deviation** is defined in terms of the squared deviations from the mean: $$\\sqrt{\\frac{(-8)^2 + (-6)^2 + (-5)^2 + (-4)^2 + (-3)^2 + (-2)^2 + (1)^2 + (2)^2 + (4)^2 + (5)^2 + (6)^2}{12 - 1}}$$\n\n## Mathematical notations\n\n::: columns\n::: {.column width=\"65%\"}\nDenote $n$ observations of a variable $x$ by $x_1, \\dots, x_n$, so that $x_i$ indicates the value of the $i$th observation. Our ages:\n\n\n::: {.cell}\n::: {.cell-output-display}\n_16_, _18_, _19_, _20_, _21_, _22_, _25_, _26_, _28_, _29_, _30_ and _34_\n:::\n:::\n\n\nApplying the notation at right:\n\n| $i$                 | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  | 11  | 12  |\n|---------------------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|\n| $x_i$               |     |     |     |     |     |     |     |     |     |     |     |     |\n| $x_i - \\bar{x}$     |     |     |     |     |     |     |     |     |     |     |     |     |\n| $(x_i - \\bar{x})^2$ |     |     |     |     |     |     |     |     |     |     |     |     |\n:::\n\n::: {.column width=\"35%\"}\nThe **mean** of the observations is written: $$\\bar{x} = \\frac{1}{n}\\sum_i x_i$$\n\nThe **standard deviation** is: $$s_x = \\sqrt{\\frac{1}{n - 1}\\sum_i (x_i - \\bar{x})^2}$$\n:::\n:::\n\n*How would you write the formula for calculating average deviation using this notation?*\n\n## Interpretations\n\nListed from largest to smallest, here are each of the measures of spread for the 12 ages:\n\n\n::: {.cell}\n::: {.cell-output-display}\n--------------------------------\n range   iqr   st.dev   avg.dev \n------- ----- -------- ---------\n  18     8.5   5.527     4.667  \n--------------------------------\n:::\n:::\n\n\nThe interpretations differ between these statistics:\n\n-   \\[range\\] all of the data lies on an interval of 18 years\n-   \\[IQR\\] the middle half of the data lies on an interval of 8.5 years\n-   \\[average deviation\\] the average distance from the mean is 4.67 years\n-   \\[standard deviation\\] the average squared distance from the mean, rescaled to years, is 5.53 years\n\n## Robustness\n\nThe IQR is more robust than any of the other measures, because outliers only affect extreme percentiles.\n\n::: columns\n::: {.column width=\"40%\"}\nConsider adding an observation of 94 to our 12 ages:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# initial range\nrange(ages)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 16 34\n```\n:::\n\n```{.r .cell-code}\n# append an outlier\nages_add <- c(ages, 94)\n\n# relative change in IQR\n(IQR(ages_add) - IQR(ages))/IQR(ages)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.05882353\n```\n:::\n\n```{.r .cell-code}\n# relative change in SD\n(sd(ages_add) - sd(ages))/sd(ages)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.640935\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"60%\"}\nThe effect of the outlier on each measure is captured by the ratio $\\frac{\\text{measure with outlier}}{\\text{measure without outlier}}$, which shows:\n\n-   the IQR increases by 5.88%\n-   the standard deviation increases by 264%\n:::\n:::\n\n## Limitations of univariate summaries\n\nSo far we have discussed **univariate** descriptive techniques --- those that pertain to one variable at a time. Consider, for example, the height and weight of participants in the FAMuSS study:\n\n::: columns\n::: {.column width=\"70%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](week3-multivariate_files/figure-revealjs/unnamed-chunk-8-1.png){width=768}\n:::\n:::\n\n:::\n\n::: {.column width=\"30%\"}\n-   both unimodal, no obvious outliers\n-   heights symmetric\n-   weights right-skewed\n-   but these observations actually come in *pairs*\n:::\n:::\n\n*The summaries we know how to make don't reflect how the variables might be related.*\n\n## Bivariate summaries\n\nBivariate (and by extension multivariate) summaries are graphical or numerical descriptions that represent two (or more) variables *jointly*.\n\n::: columns\n::: {.column width=\"60%\"}\nA simple example is a scatterplot:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week3-multivariate_files/figure-revealjs/unnamed-chunk-9-1.png){width=480}\n:::\n:::\n\n:::\n\n::: {.column width=\"40%\"}\nEach point represents a pair of values $(h, w)$ for one study participant.\n\n-   Reveals a relationship: taller participants tend to be heavier\n-   But no longer shows individual distributions clearly\n\nNotice, though, that the marginal means (dashed red lines) still capture the center well.\n:::\n:::\n\n## Summary types\n\nBivariate summary techniques differ depending on the data types of the variables being compared. Some examples the context of the FAMuSS study:\n\n| Question                                                                                                   | Comparison              |\n|------------------------------------------------------------------------------------------------------------|-------------------------|\n| Did genotype frequencies differ by race or sex among study participants?                                   | categorical/categorical |\n| Were differential changes in arm strength observed according to genotype?                                  | numeric/categorical     |\n| Did change in arm strength appear related in any way to body size among study participants?                | numeric/numeric         |\n| Did study participants experience similar or different changes in arm strength depending on arm dominance? | *??*                    |\n\n## Categorical/categorical\n\n<!-- *Did genotype frequencies differ by sex among study participants?* -->\n\nA **contingency table** is a bivariate tabular summary of two categorical variables; it shows the frequency of each pair of values. Usually the marginal totals are also shown.\n\n\n::: {.cell}\n::: {.cell-output-display}\n--------------------------------------\n   &nbsp;     CC    CT    TT    total \n------------ ----- ----- ----- -------\n **Female**   106   149   98     353  \n\n  **Male**    67    112   63     242  \n\n **total**    173   261   161    595  \n--------------------------------------\n:::\n:::\n\n\nThere are multiple ways to convert to proportions by using different denominators:\n\n-   grand total\n-   row total\n-   column total\n\nEach has a different interpretation and should be chosen according to the question of interest.\n\n## Categorical/categorical\n\n*Did genotype frequencies differ by sex among study participants?*\n\nFor this question, the **row totals** should be used to see the genotype composition of each sex.\n\n::: columns\n::: {.column width=\"50%\"}\nAs a table:\n\n\n::: {.cell}\n::: {.cell-output-display}\n---------------------------------------\n   &nbsp;       CC       CT       TT   \n------------ -------- -------- --------\n **Female**   0.3003   0.4221   0.2776 \n\n  **Male**    0.2769   0.4628   0.2603 \n---------------------------------------\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\nAs a graphic:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week3-multivariate_files/figure-revealjs/unnamed-chunk-12-1.png){width=960}\n:::\n:::\n\n:::\n:::\n\nThe proportions are quite close, suggesting minimal sex differences.\n\n## Categorical/categorical\n\n*Did sex frequencies differ by genotype among study participants?*\n\nFor this question, the **column totals** should be used to see the sex composition of each genotype.\n\n::: columns\n::: {.column width=\"50%\"}\nAs a table:\n\n\n::: {.cell}\n::: {.cell-output-display}\n---------------------------------------\n   &nbsp;       CC       CT       TT   \n------------ -------- -------- --------\n **Female**   0.6127   0.5709   0.6087 \n\n  **Male**    0.3873   0.4291   0.3913 \n---------------------------------------\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\nAs a graphic:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week3-multivariate_files/figure-revealjs/unnamed-chunk-14-1.png){width=960}\n:::\n:::\n\n:::\n:::\n\nThe proportions are close, suggesting minimal genotype differences.\n\n## Numeric/numeric\n\n*Did change in arm strength appear related in any way to body size among study participants?*\n\nComparing numeric variables is easiest accomplished by scatterplots.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week3-multivariate_files/figure-revealjs/unnamed-chunk-15-1.png){width=960}\n:::\n:::\n\n\n## Correlation\n\nIn addition to graphical techniques, for numeric/numeric comparisons, there are also quantiative measures of relationship.\n\n::: columns\n::: {.column width=\"60%\"}\n![](img/correlations.png){width=\"600\"}\n:::\n\n::: {.column width=\"40%\"}\n**Correlation** measures the strength of linear relationship, and is defined as: $$r_{xy} = \\frac{1}{n - 1}\\frac{\\sum_i (x_i - \\bar{x})(y_i - \\bar{y})}{s_x s_y}$$\n\n-   $r \\rightarrow 1$: *positive* relationship\n-   $r \\rightarrow -1$: *negative* relationship\n-   $r \\rightarrow 0$: no relationship\n:::\n:::\n\n## Uncorrelated $\\neq$ no relationship\n\nCorrelation only captures *linear* relationships. Always do a graphical check.\n\n![](img/more-correlations.png){width=\"700\"}\n\nCommon misconceptions:\n\n-   stronger correlation $\\longleftrightarrow$ greater slope\n-   weaker correlation $\\longleftrightarrow$ no relationship\n\n## Interpreting correlations\n\n*Did change in arm strength appear related in any way to body size among study participants?*\n\nHere are the correlations corresponding to the plots we checked earlier.\n\n\n::: {.cell}\n::: {.cell-output-display}\n--------------------------------------------\n   &nbsp;      height    weight      bmi    \n------------- --------- --------- ----------\n **drm.ch**    -0.1104   -0.1159   -0.07267 \n\n **ndrm.ch**   -0.265    -0.2529   -0.1436  \n--------------------------------------------\n:::\n:::\n\n\nSo there aren't any linear relationships here. A rule of thumb:\n\n-   $|r| < 0.3$: no relationship\n-   $0.3 \\leq |r| < 0.6$: weak to moderate relationship\n-   $0.6 \\leq |r| < 1$: moderate to strong relationship\n-   $|r| = 1$: either a mistake or not real data\n\n## Numeric/categorical\n\nSide-by-side boxplots are usually a good option. Avoid stacked histograms.\n\n*Were differential changes in arm strength observed according to genotype?*\n\n::: columns\n::: {.column width=\"80%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](week3-multivariate_files/figure-revealjs/unnamed-chunk-17-1.png){width=768}\n:::\n:::\n\n:::\n\n::: {.column width=\"20%\"}\nLook for differences:\n\n-   location shift\n-   spread\n-   center\n\n*What do you think? Any notable relationships?*\n:::\n:::\n",
    "supporting": [
      "week3-multivariate_files/figure-revealjs"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}