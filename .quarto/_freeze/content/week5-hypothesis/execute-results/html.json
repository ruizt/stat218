{
  "hash": "98812826661719c965024e2c723f1ef3",
  "result": {
    "markdown": "---\ntitle: \"Hypothesis testing\"\nsubtitle: \"Directional and two-sided inference for a population mean\"\nformat: \n  revealjs:\n    logo: img/poly-logo-2.jpg\n    footer: \"STAT218\"\n    smaller: true\n    mermaid:\n      theme: neutral\nexecute: \n  echo: false\n  warning: false\n  message: false\n---\n\n\n## Today's agenda\n\n\n::: {.cell}\n\n:::\n\n\n1. Reading quiz \\[[2pm section](https://forms.office.com/r/kR8D8tzbzk)\\] \\[[4pm section](https://forms.office.com/r/CNzztxACjs)\\]\n2. Hypothesis tests for a population mean\n3. Lab: $t$-tests in R\n4. (If time) Exploring decision errors\n\n## DDT data\n\nThe following are 15 measurements of the pesticide DDT in kale in parts per million (ppm). Each measurement was taken by a different laboratory.\n\n\n::: {.cell}\n::: {.cell-output-display}\n_2.79_, _2.93_, _3.22_, _3.78_, _3.22_, _3.38_, _3.18_, _3.33_, _3.34_, _3.06_, _3.07_, _3.56_, _3.08_, _4.64_ and _3.34_\n:::\n:::\n\n\n> C. E. Finsterwalder (1976) Collaborative study of an extension of the Mills et al method for the determination of pesticide residues in food. J. Off. Anal. Chem. 59, 169–171.\n\nImagine the target level for safety considerations is 3ppm or less, and you want to use this data to determine whether the mean DDT level is within safe limits.\n\n## Hypothesis testing\n\nThis is an example of a *hypothesis testing* problem: we want to test the hypothesis that mean DDT in kale is within safe limits. Hypothesis testing is another form of statistical inference.\n\nThe general pattern for performing a hypothesis test is:\n\n1.  Formulate the hypothesis to test in terms of the values of a population parameter.\n2.  Assess the likelihood of the data under the hypothesis through use of a \"test statistic\".\n3.  Conclude whether the data provide evidence favoring an alternative.\n\nToday we'll cover each step in turn in the context of tests for a population mean.\n\n## 1. Formulating hypotheses\n\nHypotheses cannot be tested in isolation, but must be considered relative to a specified alternative.\n\nTo articulate the hypotheses for a test, we need:\n\n-   population parameter of interest\n-   **null hypothesis** $H_0$: possible value(s) under the claim to be tested\n-   **alternative hypothesis** $H_A$: possible value(s) if the claim is found to be false\n\nIn the context of the DDT example...\n\n$$H_0:\\hspace{15cm}$$ $$H_A:\\hspace{15cm}$$\n\n## 2. Test statistic\n\nTest statistics are data summaries that:\n\n-   depend on the null value of the population parameter\n-   have a known sampling distribution\n\nFor a population mean, we use: $$T = \\frac{\\bar{x} - \\mu_0}{s_x/\\sqrt{n}}$$\n\nThis is well-described by a $t_{n - 1}$ model when $\\mu = \\mu_0$. It is useful for the test because:\n\n-   large (absolute) values of $T$ are unlikely if $\\mu = \\mu_0$\n-   small (absolute) values of $T$ are expected if $\\mu = \\mu_0$\n\n## 3. Drawing a conclusion\n\n::: columns\n::: {.column width=\"60%\"}\nIn the DDT example, $T$ = 2.906. This favors $H_A$, but by how much?\n\nAccording to the $t$ model, less than 1% of samples would produce a result *more* favorable to $H_A$.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](week5-hypothesis_files/figure-revealjs/unnamed-chunk-3-1.png){width=768}\n:::\n:::\n\n:::\n\n::: {.column width=\"40%\"}\nPoint estimate:\n\n\n::: {.cell}\n::: {.cell-output-display}\n----------------\n mean      se   \n------- --------\n 3.328   0.1129 \n----------------\n:::\n:::\n\n\nTest statistic:\n\n$$T = \\frac{\\bar{x} - \\mu_0}{SE(\\bar{x})} = $$\n\n> This is strong evidence *against* the claim that the DDT level is 3ppm or less and *in favor of* the claim that the DDT level exceeds 3ppm.\n:::\n:::\n\n## Recap of DDT example\n\n> Is the mean DDT level in kale 3ppm or less?\n\n::: {.columns}\n\n::: {.column width=\"55%\"}\nData are measurements of DDT levels in ppm from 15 labs. \n\nPopulation parameter:\n\n$$H_0:\\hspace{15cm}$$ \n$$H_A:\\hspace{15cm}$$ \n$$\\mu_0 =\\hspace{15cm}$$ \n$$T=\\hspace{15cm}$$ \n% of samples more favorable to $H_A \\approx$ \n:::\n\n::: {.column width=\"45%\"}\nSummary statistics:\n\n::: {.cell}\n::: {.cell-output-display}\n-------------------------\n mean      sd       se   \n------- -------- --------\n 3.328   0.4372   0.1129 \n-------------------------\n:::\n:::\n\n$t_{14}$ model:\n\n::: {.cell}\n::: {.cell-output-display}\n![](week5-hypothesis_files/figure-revealjs/unnamed-chunk-6-1.png){width=384}\n:::\n:::\n\n\n:::\n\n:::\n\n\n## Another example: sleep\n\n> Does the average U.S. adult sleep at least 7 hours per night?\n\n::: {.columns}\n\n::: {.column width=\"55%\"}\nData are reported average hours of sleep per night from 135 NHANES respondents. \n\nPopulation parameter:\n\n$$H_0:\\hspace{15cm}$$ \n$$H_A:\\hspace{15cm}$$ \n$$\\mu_0 =\\hspace{15cm}$$ \n$$T=\\hspace{15cm}$$ \n% of samples more favorable to $H_A \\approx$ \n:::\n\n::: {.column width=\"45%\"}\nSummary statistics:\n\n::: {.cell}\n::: {.cell-output-display}\n----------------------\n mean     sd      se  \n------- ------- ------\n 6.896   1.394   0.12 \n----------------------\n:::\n:::\n\n$t_{134}$ model:\n\n::: {.cell}\n::: {.cell-output-display}\n![](week5-hypothesis_files/figure-revealjs/unnamed-chunk-8-1.png){width=384}\n:::\n:::\n\n\n:::\n\n:::\n\n\n## Your turn: body temperatures\n\n\n> Is mean body temperature actually 98.6 °F, or is it lower?\n\n::: {.columns}\n\n::: {.column width=\"55%\"}\nData are 130 observations of body temperature (°F) [derived from a JAMA study](https://jse.amstat.org/v4n2/datasets.shoemaker.html). \n\nPopulation parameter:\n\n$$H_0:\\hspace{15cm}$$ \n$$H_A:\\hspace{15cm}$$ \n$$\\mu_0 =\\hspace{15cm}$$ \n$$T=\\hspace{15cm}$$ \n% of samples more favorable to $H_A \\approx$ \n:::\n\n::: {.column width=\"45%\"}\nSummary statistics:\n\n::: {.cell}\n::: {.cell-output-display}\n-------------------------\n mean      sd       se   \n------- -------- --------\n 98.25   0.7332   0.0643 \n-------------------------\n:::\n:::\n\n$t_{129}$ model:\n\n::: {.cell}\n::: {.cell-output-display}\n![](week5-hypothesis_files/figure-revealjs/unnamed-chunk-10-1.png){width=384}\n:::\n:::\n\n\n:::\n\n:::\n\n\n## Strength of evidence\n\nThe result that 0.575% of samples would produce a test statistic more strongly favoring the alternative hypothesis is an example of a ***p*****-value**:\n\n> the probability under $H_0$ of obtaining a sample for which the test statistic is at least as favorable to $H_A$ as the value actually observed\n\nIn other words, $p$-values assume the null hypothesis is true, and then ask, \"what is the chance I'd obtain data at least as suggestive as what I have that the alternative is more likely than the null?\"\n\n-   smaller $p$-values: if $H_0$ is true, equally or more favorable results are not expected often by chance\n-   larger $p$-values: if $H_0$ is true, equally or more favorable results are expected often by chance\n\n\n## Evidence thresholds\n\nIt remains to define an *evidence threshold* above which we decide to reject $H_0$.\n\nA heuristic is to fix a **significance level** $\\alpha$ and reject $H_0$ whenever $p < \\alpha$.\n\n-   represents an evidence threshold\n-   conventionally, $\\alpha = 0.05$\n-   controls error rates\n\nImagine that indeed mean DDT in kale is 3ppm. Then 0.575% of samples produce test statistics at least as favorable to the alternative as what we saw in the study.\n\n-   so if we set the evidence threshold for rejecting $H_0$ exactly here ($\\alpha = 0.00575$) we'll be wrong 0.575% of the time\n-   if we set the evidence threshold lower (say $\\alpha = 0.01$) we'll be wrong more than 0.575% of the time (in fact 1% of the time)\n\n## Interpreting results\n\nBecause of the anatomy of hypothesis tests, there are two possible findings:\n\n-   \\[above evidence threshold\\] reject $H_0$ in favor of $H_A$\n-   \\[below evidence threshold\\] fail to reject $H_0$\n\n> Since the null is assumed to be true to perform the test, the test can only result in (a) evidence against this assumption or (b) no evidence against this assumption. But because it's an assumption, we don't affirm it if the test fails.\n\nIn the DDT example: *the data provide sufficiently strong evidence (p = 0.00575) to reject the hypothesis that mean DDT in kale is at most 3ppm in favor of the hypothesis that mean DDT in kale exceeds 3ppm*.\n\n<!-- ## Decision errors -->\n\n<!-- There are two ways to make mistakes, and two ways to get the answer right. -->\n\n<!-- ![](img/testing-errors.png){fig-align=\"center\" width=\"200\"} -->\n\n<!-- You can't optimize both error rates simultaneously. -->\n\n<!-- -   The test heuristics we've outlined control type I error rates at $\\alpha$ -->\n\n<!-- -   These tests have the lowest type II error rates *subject to* a limit on type I error -->\n\n## Composite hypotheses\n\nThe null hypothesis is a *composite* of values, so why did we choose just one ($\\mu_0 = 3$) to perform the test?\n\nAny null value farther from the alternative will produce stronger results.\n\n| Null value     | Test statistic numerator | Proportion of samples more favorable to $H_A$                           |\n|------------------------|------------------------|------------------------|\n| $\\mu_0 = 3$    | 0.328        | 0.00575    |\n| $\\mu_0 = 2.99$ | 0.338     | 0.00483 |\n| $\\mu_0 = 2.95$ | 0.378     | 0.00239 |\n\nSo by using $\\mu_0 = 3$, we are choosing the most conservative null value for the test.\n\n## Components of a test\n\n| Component              | Explanation                                                                  | DDT example                                       |\n|------------------------|------------------------|------------------------|\n| Population parameter   | The quantity of interest                                                     | Mean DDT $\\mu$                                    |\n| Null hypothesis        | The claim to be tested                                                       | $\\mu \\leq 3$                                      |\n| Alternative hypothesis | The alternative claim                                                        | $\\mu > 3$                                         |\n| Test statistic         | A function of the sample data and the null value of the population parameter | $T = \\frac{\\bar{x} - \\mu_0}{s_x/\\sqrt{n}} = 2.91$ |\n| Model                  | Sampling distribution of the test statistic under $H_0$                      | $t_{df = 14}$ model                               |\n| $p$-value              | Probability under $H_0$ of obtaining a result at least as favorable to $H_A$ | 0.575% of samples are more favorable to $H_A$     |\n| Decision               | Reject or fail to reject $H_0$                                               | Reject at $\\alpha = 0.05$                         |\n\n## Performing tests in R\n\n\n::: {.columns}\n\n::: {.column}\n\nInputs:\n\n1. data vector\n2. null value of parameter\n3. alternative hypothesis\n\nOutputs:\n\n4. test statistic\n5. degrees of freedom for $t$ model\n6. $p$-value\n7. confidence interval\n8. point estimate\n\n:::\n\n::: {.column}\n`t.test` performs all calculations. Locate each input (1-3) and output (4-7) below:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(ddt, mu = 3, alternative = 'greater')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  ddt\nt = 2.9059, df = 14, p-value = 0.005753\nalternative hypothesis: true mean is greater than 3\n95 percent confidence interval:\n 3.129197      Inf\nsample estimates:\nmean of x \n    3.328 \n```\n:::\n:::\n\n\n:::\n\n:::\n\n\n## Directional hypotheses\n\nTests for the mean can involve directional or non-directional alternatives. We refer to these as one-sided and two-sided tests, respectively.\n\n| Test type   | Null             | Alternative      | Favors alternative |\n|-------------|------------------|------------------|--------------------|\n| Upper-sided | $\\mu \\leq \\mu_0$ | $\\mu > \\mu_0$    | positive $T$       |\n| Lower-sided | $\\mu \\geq \\mu_0$ | $\\mu < \\mu_0$    | negative $T$       |\n| Two-sided   | $\\mu = \\mu_0$    | $\\mu \\neq \\mu_0$ | large $|T|$        |\n\nThe direction of the test affects the $p$-value calculation (and thus decision), but *won't* change the test statistic.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# upper-sided\nt.test(ddt, mu = mu_0, alternative = 'greater')\n\n# lower-sided\nt.test(ddt, mu = mu_0, alternative = 'less')\n\n# two-sided (default)\nt.test(ddt, mu = mu_0, alternative = 'two.sided')\n```\n:::\n\n\n## Lab: $t$-tests in R\n\nOpen up `lab6-hypotesting` in the class workspace. The goals for this lab are:\n\n1. Learn how to implement $t$ tests in R and interpret output\n2. Practice formulating and testing hypotheses from simple research questions\n3. (If time) Explore decision errors",
    "supporting": [
      "week5-hypothesis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}