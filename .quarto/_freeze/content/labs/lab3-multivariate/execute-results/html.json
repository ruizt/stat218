{
  "hash": "9771e12a70221efd44d12e0a3086ebe6",
  "result": {
    "markdown": "---\ntitle: \"Lab 3: More descriptive statistics\"\nauthor: \"STAT218\"\nauthor-title: \"Course activity\"\nexecute: \n  eval: false\nformat: \n  html:\n    toc: true\n  docx:\n    toc: false\nprefer-html: true\nembed-resources: true\n---\n\n\nThis lab covers two separate topics: measures of spread and bivariate graphical summaries. There are two goals for the activity:\n\n-   learn to calculate measures of spread (IQR and standard deviation) and explore their robustness to outliers\n-   learn to produce joint summaries of two variables for identifying relationships\n    -   contingency tables\n    -   proportional barplots\n    -   scatterplots\n    -   side-by-side boxplots\n\nWe will use the FAMuSS dataset again.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# openintro biostat package\nlibrary(oibiostat)\n\n# famuss data\ndata(famuss)\n```\n:::\n\n\n### Robustness and measures of spread\n\nLet's explore how some of the other descriptive statistics we've discussed behave in response to outliers. Specifically, measures of spread: standard deviation and IQR.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# extract dominant arm percent change in strength\ndrm <- famuss$drm.ch\n\n# calculate standard deviation\nsd(drm)\n\n# interquartile range\nIQR(drm)\n\n# average deviation\nmean(abs(drm - mean(drm)))\n\n# range\nmax(drm) - min(drm)\n\n# range endpoints\nrange(drm)\n```\n:::\n\n\nThe variable you just looked at — dominant arm percent change in strength — has a group of observations over 60%.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# boxplot of percent change in dominant arm strength\nboxplot(drm, horizontal = T, range = 2)\n```\n:::\n\n\nIf these are removed, the standard deviation increases by 24%, but the IQR only increases by 18%.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# drop the observations over 60%\ndrm.drop <- drm[drm < 60]\n\n# compute the numeric summary with and without outliers\nsummary(drm)\nsummary(drm.drop)\n\n# compare standard deviations\nsd(drm)/sd(drm.drop)\n\n# compare interquartile ranges\nIQR(drm)/IQR(drm.drop)\n```\n:::\n\n\nThis may not seem very notable, so let's make up an example that's a bit more extreme: let's add a very large positive observation, say, 1000. Then, the IQR does not change at all, but the standard deviation more than doubles!\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add a large observation\ndrm.add <- c(drm, 1000)\n\n# compare IQR with and without\nIQR(drm.add)/IQR(drm)\n\n# compare SD with and without\nsd(drm.add)/sd(drm)\n```\n:::\n\n\nThe differences in robustness between IQR and standard deviation, and between mean and median, are largely why *both* the five-number summary *and* the mean and standard deviation are reported. When these statistics differ dramatically, it is most likely due to the presence of outliers!\n\n::: callout-note\n## Your turn\n\nCompute the numeric summary for a variable from a different dataset and *based on this alone* attempt a guess at whether there are outliers. If so, are they more likely outliers to the left or right?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load a new dataset (census)\ndata(census.2010)\n\n# number of doctors per state (thousands)\ndoctors <- census.2010$doctors\n\n# compute numeric summary -- guess whether there are outliers?\n\n# make a histogram or boxplot to confirm your guess\n\n# bonus: can you figure out which state??\n```\n:::\n\n:::\n\n### Bivariate graphics\n\nThis part of the lab is organized according to which types of variables are being compared as potentially related. In each sub-part, you'll see a series of examples that illustrate how to produce a given graphic or other summary, and then you'll have an opportunity to try it with a different pair of variables from the FAMuSS study data.\n\n#### Categorical/categorical\n\nConsider: *is there differential expression of the ACTN gene region of interest between sexes?*\n\nThis can be answered by comparing the proportions of study participants of each genotype by sex. The steps are:\n\n1.  Start by making a contingency table\n2.  Convert to proportions using the appropriate row/column sums\n3.  Visualize and compare genotype composition by group\n\nThe examples below illustrate how to perform these steps. As you're walking through them, consider which summary answers the question — do you want to compute proportions using the genotype totals or the sex totals?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# retrieve the genotype and sex columns\ngenotype <- famuss$actn3.r577x\nsex <- famuss$sex\n\n# construct a contingency table\ntable(genotype, sex)\n\n# stacked bar plots -- automatically groups by column\ntbl <- table(famuss$actn3.r577x, famuss$sex)\nbarplot(tbl, legend = T)\n\n# turn the table on its side with t() to group by row\nbarplot(t(tbl), legend = T)\n\n# row and column margins\nrowSums(tbl)\ncolSums(tbl)\n\n# proportions, grouping by row\ntbl_row <- tbl/rowSums(tbl)\ntbl_row\n\n# proportional stacked bar plot, grouped by row\nbarplot(t(tbl_row), legend = T)\n\n# proportions, grouping by column (a little trickier)\ntbl_col <- t(t(tbl)/colSums(tbl))\ntbl_col\n\n# proportional stacked bar plot, groupde by column\nbarplot(tbl_col, legend = T, horiz = T)\n```\n:::\n\n\n::: callout-note\n## Your turn\n\n*Is there differential expression of the ACTN gene region by racial group?*\n\nFollow the examples above to make a contingency table and bar plot of genotype composition for each racial group. Do you see differences?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# retrieve the genotype and race columns\n\n# make a contingency table of genotype and race\n\n# are there apparent genotype differences by race? make an appropriate bar plot\n```\n:::\n\n:::\n\n#### Numeric/numeric\n\nTaller people tend to be heavier. We should expect a relationship between weight and height. The example below shows a scatterplot of the two variables, and computes the correlation (measure of linear relationship).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# retrieve height and weight columns\nheight <- famuss$height\nweight <- famuss$weight\n\n# basic scatterplot\nplot(height, weight)\n\n# correlation\ncor(weight, height)\n```\n:::\n\n\nA rough rule of thumb for interpreting correlations is as follows:\n\n-   $|r| < 0.3$: no relationship\n-   $0.3 \\leq |r| < 0.6$: weak to moderate relationship\n-   $0.6 \\leq |r| < 1$: moderate to strong relationship\n\nIn this case, the correlation of 0.53 indicates a moderate positive relationship.\n\n::: callout-note\n## Your turn\n\nIs there a relationship between nondominant and dominant percent change in arm strength? Make a scatterplot and compute the correlation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# retrieve the percent change variables\n\n# construct a scatterplot\n\n# compute the correlation\n```\n:::\n\n:::\n\n#### Categorical/numeric\n\nConsider one of the main questions for the study:\n\n> *Were differences on the ACTN gene region associated with differential change in arm strength after resistance training?*\n\nThis is a comparison between a categorical variable (genotype) and numeric variable (percent change in arm strength). Of course, we have measurements for both dominant and non-dominant arms; while there are other ways of handling this, we'll just make comparisons separately for each arm.\n\nThe examples below produce boxplots for a quick comparison of the summary statistics of percent change in arm strength between genotypes. Recall that the summary statistics are summarizing the frequency distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# side-by-side boxplots for non-dominant arm\nboxplot(ndrm.ch ~ actn3.r577x, data = famuss)\n\n# change the orientation \nboxplot(ndrm.ch ~ actn3.r577x, data = famuss, horizontal = T)\n\n# change the whisker length (range = multiples of IQR)\nboxplot(ndrm.ch ~ actn3.r577x, data = famuss, horizontal = T, range = 2)\n\n# side-by-side boxplots for dominant arm\nboxplot(drm.ch ~ actn3.r577x, data = famuss, horizontal = T)\n```\n:::\n\n\nThere are some slight observed differences for the non-dominant arm, but it's unclear whether they are meaningful. We'll return to that later, but for now, try the graphical technique with a different set of variables.\n\n::: callout-note\n## Your turn\n\nInvestigate whether BMI seems to differ by racial group among the FAMuSS study participants.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# make side-by-side boxplots of BMI by race\n```\n:::\n\n:::\n\n\n::: {.cell}\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}