{
  "hash": "9c2f174190bb4a67aa5b73cb4abba286",
  "result": {
    "markdown": "---\ntitle: \"Lab 6: Hypothesis testing\"\nauthor: \"STAT218\"\nauthor-title: \"Course activity\"\nexecute: \n  eval: true\n  results: 'markup'\nformat: \n  html:\n    toc: true\n  docx:\n    toc: false\nprefer-html: true\nembed-resources: true\n---\n\n\nThe objective of this lab is to learn how to perform $t$-tests for a population mean in R. We will cover:\n\n- specifying null and alternative hypotheses\n- interpreting R output\n\n## Datasets\n\nIn this lab we'll use two datasets:\n\n- `ddt` are the 15 measurements from lecture of DDT level (ppm) in kale\n- `body.temps` are 130 observations of body temperature from a sample of US adults\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(oibiostat)\n\nddt <- MASS::DDT\nstr(ddt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n num [1:15] 2.79 2.93 3.22 3.78 3.22 3.38 3.18 3.33 3.34 3.06 ...\n```\n:::\n\n```{.r .cell-code}\ndata(thermometry)\nbody.temps <- thermometry$body.temp\nstr(body.temps)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n num [1:130] 96.3 96.7 96.9 97 97.1 97.1 97.1 97.2 97.3 97.4 ...\n```\n:::\n:::\n\n\n\n## Performing a $t$ test in R\n\nWe'll illustrate the use of `t.test` with the `ddt` data. The parameter of interest here is:\n\n$$\n\\mu = \\text{mean DDT in kale}\n$$\n\n### Upper-sided test\n\nConsider first testing the hypotheses:\n\n$$\n\\begin{align*}\nH_0: \\mu \\leq 3 \\qquad(\\text{mean DDT in kale} \\leq 3) \\\\\nH_A: \\mu > 3 \\qquad(\\text{mean DDT in kale} > 3)\n\\end{align*}\n$$\n\nThe null parameter value is the cutoff point $\\mu_0 = 3$. This is an *upper-sided* test because the alternative specifies that the parameter *exceeds* the null value. We implement this test by providing as arguments to `t.test`:\n\n- data vector `ddt`\n- null parameter value `mu = 3`\n- upper sided alternative `alternative = 'greater'`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# upper sided test H0: mean ddt <= 3 vs HA: mean ddt > 3\nt.test(ddt, mu = 3, alternative = 'greater')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  ddt\nt = 2.9059, df = 14, p-value = 0.005753\nalternative hypothesis: true mean is greater than 3\n95 percent confidence interval:\n 3.129197      Inf\nsample estimates:\nmean of x \n    3.328 \n```\n:::\n:::\n\n\nTake a moment to locate each of the following outputs:\n\n- test statistic value\n- degrees of freedom for the $t$ model\n- $p$-value\n- confidence interval for the mean\n- point estiamte for the mean\n\nSince $p < 0.05$, we reject $H_0$ at significance level $\\alpha = 0.05$. Interpret the result:\n\n> The data provide sufficiently strong evidence to reject the null hypothesis that mean DDT in kale is at most 3 ppm in favor of the alternative hypothesis that mean DDT in kale exceeds 3ppm (p = 0.00575).\n\n### Lower-sided test\n\nNow suppose you wish to test whether the mean DDT in kale is at least 3.5ppm.\n\n$$\n\\begin{align*}\nH_0: \\mu \\geq 3.5 \\qquad(\\text{mean DDT in kale} \\geq 3.5) \\\\\nH_A: \\mu < 3.5 \\qquad(\\text{mean DDT in kale} < 3.5)\n\\end{align*}\n$$\n\nThe null parameter value is the cutoff point $\\mu_0 = 3.5$. This is a *lower-sided* test because the alternative specifies that the parameter *is smaller than* the null value. We implement this test by providing as arguments to `t.test`:\n\n- null parameter value `mu = 3.5`\n- upper sided alternative `alternative = 'less'`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# lower-sided test, H0: mean ddt >= 3.5 vs HA: mean ddt < 3.5\nt.test(ddt, mu = 3.5, alternative = 'less')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  ddt\nt = -1.5238, df = 14, p-value = 0.07491\nalternative hypothesis: true mean is less than 3.5\n95 percent confidence interval:\n     -Inf 3.526803\nsample estimates:\nmean of x \n    3.328 \n```\n:::\n:::\n\n\nSince $p > 0.05$, we fail to reject $H_0$ at significance level $\\alpha = 0.05$. Interpret the result:\n\n> The data **do not** provide sufficiently strong evidence to reject the null hypothesis that mean DDT in kale is at least 3.5 ppm in favor of the alternative hypothesis that mean DDT in kale exceeds 3.5ppm (p = 0.075).\n\n### Two-sided test\n\nLastly, suppose we wish to test whether mean DDT is 3 or not.\n\n$$\n\\begin{align*}\nH_0: \\mu = 3 \\qquad(\\text{mean DDT in kale} = 3) \\\\\nH_A: \\mu \\neq 3 \\qquad(\\text{mean DDT in kale} \\neq 3)\n\\end{align*}\n$$\n\nThe null parameter value is the point $\\mu_0 = 3$. This is a *two-sided* test because the alternative specifies that the parameter *is either greater or smaller than* the null value. We implement this test by providing as arguments to `t.test`:\n\n- null parameter value `mu = 3`\n- upper sided alternative `alternative = 'two.sided'`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# two-sided test, H0: mean ddt == 3 vs HA: mean ddt =!= 3\nt.test(ddt, mu = 3, alternative = 'two.sided')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  ddt\nt = 2.9059, df = 14, p-value = 0.01151\nalternative hypothesis: true mean is not equal to 3\n95 percent confidence interval:\n 3.085913 3.570087\nsample estimates:\nmean of x \n    3.328 \n```\n:::\n:::\n\n\nSince $p < 0.05$, we reject $H_0$ at significance level $\\alpha = 0.05$. Interpret the result:\n\n> The data provide sufficiently strong evidence to reject the null hypothesis that mean DDT in kale is 3 ppm in favor of the alternative hypothesis that mean DDT in kale is not 3ppm (p = 0.012).\n\nNotice that, the evidence against the null is slightly weaker with respect to the two-sided alternative than with respect to the upper-sided alternative. This makes sense, because the alternative comprises a larger range of values, some of which are not very consistent with the data.\n\n## Answering questions with $t$ tests\n\n### Body temperatures\n\nAnswer the following questions with hypothesis tests using the `body.temps` data. Be sure to consider how to frame the hypotheses appropriately to answer the question.\n\n1. Is the mean body temperature different from 98.6 °F?\n2. Is the mean body temperature higher than 98 °F?\n3. Is the mean body temperature higher than 98.2 °F?\n4. Is the mean body temperature lower than 98.2 °F?\n5. Is the mean body temperature actually 98.2 °F?\n6. Is the mean body temperature actually 98.3 °F?\n\n\n\n::: callout-note\n## Your turn\n\nWrite commands to perform tests to answer questions 1-6 above.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1. Is the mean body temperature different from 98.6 °F?\n\n# 2. Is the mean body temperature higher than 98 °F?\n\n# 3. Is the mean body temperature higher than 98.2 °F?\n\n# 4. Is the mean body temperature lower than 98.2 °F?\n\n# 5. Is the mean body temperature actually 98.2 °F?\n\n# 6. Is the mean body temperature actually 98.3 °F?\n```\n:::\n\n\nInterpret the result of each test in context. Use significance level $\\alpha = 0.05$ to make a decision.\n\n:::\n\n::: callout-tip\n## Remark\n\nThe hypothesis tests suggest that in fact, mean body temperature is lower than commonly thought. However, a visual inspection of the data reveals an interesting twist: the body temperature data are actually bimodal!\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lab6-hypotesting_files/figure-html/body temp plot-1.png){width=672}\n:::\n:::\n\n\nThis doesn't invalidate any of our inferences, but suggests that we might be asking the wrong question by focusing on the population mean if, in fact, there is no *one* mean body temperature. We should perhaps ask instead, what feature of the population explains the bimodal distribution?\n:::\n\n",
    "supporting": [
      "lab6-hypotesting_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}