{
  "hash": "6df20c9f61031d2c73a5f18d3d280a21",
  "result": {
    "markdown": "---\ntitle: \"Lab 8: Two-sample inference\"\nauthor: \"STAT218\"\nauthor-title: \"Course activity\"\nexecute: \n  eval: true\n  results: 'markup'\nformat: \n  html:\n    toc: true\n  docx:\n    toc: false\nprefer-html: true\nembed-resources: true\n---\n\n\n\nThis lab focuses on two-sample inference for differences in population means using paired and independent data. The main objectives are:\n\n1. Learn to implement two-sample tests in R\n2. Practice distinguishing between paired and independent data settings\n\nOur goal is to learn implementations, so less focus will be placed on interpretation in these instructions; however, we will discuss interpretations as we go. \n\n## Datasets\n\nThe lab uses several datasets for which we will consider two-sample comparisons:\n\n- `swim`: compare swimming velocities in a bodysuit and in a swimsuit\n- `famuss`: compare changes in dominant and nondominant arm strength after resistance training\n- `finch`: compare finch beak depths the generation before a drought and the generation after\n- `diets`: compare blood pressure on a fish oil diet and a regular oil diet\n- `sleep`: compare extra sleep gained on two different soporific drugs\n\nYou should run the lines below before beginning the lab to load all five datasets into your environment.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(oibiostat)\nlibrary(Sleuth3)\ndata(swim)\ndata(famuss)\ndata(sleep)\nfinch <- case0201\ndiets <- ex0112\ncloud <- case0301\n```\n:::\n\n\n\n\n## Performing two sample tests\n\nFirst we'll cover examples of tests for paired and independent tests, and you'll practice implementing each on a new dataset. \n\nThe goal of two-sample inference is to make a comparison of means between two groups based on two sets of observations (one per group). This is usually structured as follows:\n\n- one variable of interest\n- a grouping of observations into two groups\n- possibly, a pairing of observations between groups\n\n### Paired data\n\nRecall that **pairing** refers to matching the observations between the two groups of interest. This is most often done when the study units are the same in each group. In the swim data, for example, each swimmer's velocity is measured once in a bodysuit and once in a swimsuit. If $\\mu$ denotes mean velocity, we want to test:\n\n$$H_0: \\mu_\\text{bodysuit} \\leq \\mu_\\text{swimsuit} $$\n$$H_A: \\mu_\\text{bodysuit} > \\mu_\\text{swimsuit} $$\n\nBecause of the pairing, we can compute the difference in velocity for each swimmer and use that to test the hypotheses. There are two steps in this case:\n\n1. Calculate pairwise differences\n2. Perform a one-sample test with the appropriate direction\n\nThis is shown below:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# step 1: compute difference wetsuit - swimsuit\nvelocity.diff <- swim$wet.suit.velocity - swim$swim.suit.velocity\n\n# step 2: perform one-sample t test\nt.test(velocity.diff, mu = 0, alternative = 'greater')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  velocity.diff\nt = 12.318, df = 11, p-value = 4.443e-08\nalternative hypothesis: true mean is greater than 0\n95 percent confidence interval:\n 0.06620114        Inf\nsample estimates:\nmean of x \n   0.0775 \n```\n:::\n:::\n\n\n\n\n::: callout-note\n## Your turn\n\nIn the FAMuSS data, changes in arm strength by dominant and nondominant arms are paired by participant. Use this pairing to test the hypotheses\n\n$$H_0: \\mu_\\text{drm} \\geq \\mu_\\text{ndrm}$$\n$$H_A: \\mu_\\text{drm} < \\mu_\\text{ndrm}$$\nwhere $\\mu$ denotes mean change in arm strength. Be careful about the direction of the test; make sure this matches the sign of the pairwise differences appropriately.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# inspect data\nhead(famuss)\n\n# compute difference ndrm.ch - drm.ch\nstrength.diff <- ...\n\n# perform t test\nt.test(...)\n```\n:::\n\n\n:::\n\n### Independent data\n\nFor independent data, the problem is the same but without the pairing. If the sample sizes differ between groups, that's a dead giveaway that data are very likely not paired (unless observations are missing). Otherwise, you'll need to reflect on whether it is possible to match the observations in each group.\n\nIn the `finch` data, the observations in each group come from different individual finches of generations two years apart, so there is no sensible way to pair the data. The goal is to determine whether beak depth increased as a result of selection pressure following a drought in 1977. So, with $\\mu$ denoting mean beak depth, let's test the hypotheses:\n\n$$H_0: \\mu_\\text{1978} \\leq \\mu_\\text{1976}$$\n$$H_A: \\mu_\\text{1978} > \\mu_\\text{1976}$$\nThe implementation is shown below. Notice that *unlike* in the one-sample case, we provide the data as a data frame with a grouping column and a column for the variable of interest, and specify the grouping using the formula `variable ~ group`. Otherwise the input format is analogous to the one-sample case.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# examine data; note that grouping is shown as a variable\nhead(finch)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Year Depth\n1 1976   6.2\n2 1976   6.8\n3 1976   7.1\n4 1976   7.1\n5 1976   7.4\n6 1976   7.8\n```\n:::\n\n```{.r .cell-code}\n# perform t test\nt.test(Depth ~ Year, data = finch, mu = 0, alternative = 'less')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  Depth by Year\nt = -4.5833, df = 172.98, p-value = 4.37e-06\nalternative hypothesis: true difference in means between group 1976 and group 1978 is less than 0\n95 percent confidence interval:\n      -Inf -0.427321\nsample estimates:\nmean in group 1976 mean in group 1978 \n          9.469663          10.138202 \n```\n:::\n:::\n\n\n\n::: callout-note\n## Your turn\n\nTry implementing the two-sample test for independent data using a new dataset. The `diets` data show reductions in diastolic blood pressures for 14 participants who were randomly assigned one of two diets: fish oil and regular oil. Because the participants in each group are unrelated, there is no pairing of observations.\n\nUse these data to test whether fish oil leads to a greater reduction in blood pressure:\n\n$$H_0: \\mu_\\text{fish} \\leq \\mu_\\text{regular}$$\n$$H_A: \\mu_\\text{fish} > \\mu_\\text{regular}$$\nAgain, careful about the direction of the alternative. You might need to try once and inspect output to make sure you performed the test indicated above.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# inspect data\nhead(diets)\n\n# perform test\nt.test(..., data = ..., mu = ..., alternative = ...)\n```\n:::\n\n\n:::\n\n\n## Distinguishing paired from independent data\n\nHere you'll practice distinguishing the paired and independent settings, as well as get further practice implementing the tests above. You're given two datasets, and must:\n\n1. Determine whether pairing is present\n2. Conduct the appropriate test\n\nYou should discuss the pairing question with your group after inspecting the datasets but before carrying out any inference.\n\n### Cloud seeding data\n\nThe cloud seeding data are shown below, and comprise observations of rainfall in a target area on 26 days when clouds were seeded with silver iodide and on 26 different days when clouds were not seeded.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# inspect data\nhead(cloud)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Rainfall Treatment\n1   1202.6  Unseeded\n2    830.1  Unseeded\n3    372.4  Unseeded\n4    345.5  Unseeded\n5    321.2  Unseeded\n6    244.3  Unseeded\n```\n:::\n:::\n\n\n\nWith $\\mu$ denoting mean rainfall (in acre-feet), the goal is to test:\n\n$$H_0: \\mu_\\text{seeded} \\leq \\mu_\\text{unseeded}$$\n$$H_A: \\mu_\\text{seeded} > \\mu_\\text{unseeded}$$\n\n### Sleep data\n\nThe sleep data are shown below and comprise observations of extra hours of sleep of 10 study participants on one of two drugs. The variable `extra` records extra hours of sleep, `group` records which drug was taken, and `ID` records the study participant.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# inspect data after ordering by participant ID\ndplyr::arrange(sleep, ID) |> head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  extra group ID\n1   0.7     1  1\n2   1.9     2  1\n3  -1.6     1  2\n4   0.8     2  2\n5  -0.2     1  3\n6   1.1     2  3\n```\n:::\n:::\n\n\n\nWith $\\mu$ denoting mean extra hours of sleep, the goal is to test with this data whether one drug is better than the other:\n\n$$H_0: \\mu_1 = \\mu_2$$\n$$H_A: \\mu_1 \\neq \\mu_2$$\nThe hypotheses are non-directional because there is not a prior hypothesis about which drug might be better.\n\n::: callout-note\n## Your turn\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# test whether cloud seeding increases rainfall\n\n# test whether sleep drugs produce different effects\n```\n:::\n\n\n:::\n\n",
    "supporting": [
      "lab8-twosample_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}