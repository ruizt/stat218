values_to = 'velocity') %>%
head(5) %>%
pander()
swim %>%
transmute(swimmer = swimmer,
body = body.suit.velocity,
swim = swim.suit.velocity) %>%
pivot_longer(c(body, swim),
names_to = 'suit',
values_to = 'velocity') %>%
head(5) %>%
pander()
data(famuss)
head(famuss)
head(famuss, 4) %>% pander()
t.test(famuss$drm.ch - famuss$ndrm.ch, mu = 0, alternative = "less")
t.test(famuss$ndrm.ch - famuss$drm.ch, mu = 0, alternative = "less")
t.test(famuss$ndrm.ch - famuss$drm.ch, mu = 0, alternative = "greater")
data(swim)
data(famuss)
t.test(velocity.diff, mu = 0, alternative = 'greater')
library(oibiostat)
data(swim)
data(famuss)
velocity.diff <- swim$wet.suit.velocity - swim$swim.suit.velocity
t.test(velocity.diff, mu = 0, alternative = 'greater')
# compute difference wetsuit - swimsuit
velocity.diff <- swim$wet.suit.velocity - swim$swim.suit.velocity
# perform t test
t.test(velocity.diff, mu = 0, alternative = 'greater')
sleep
?sleep
health
Sleuth3::ex0112
Sleuth3::case0301
Sleuth3::case0201
?Sleuth3::case0201
?Sleuth3::case0301
sleep
t.test(extra ~ group, data = sleep)
t.test(extra ~ group, data = sleep, alternative = 'less')
?sleep
sleep
cholesterol
case0201
case0301
?case0301
?case0201
case0201
case0201
case0201 %>%
group_by(Year) %>%
sample_n(size = 3)
case0201 %>%
group_by(Year) %>%
sample_n(size = 3) %>%
pander()
case0201
case0201 %>% count(year)
case0201 %>% count(Year)
finch <- case0201
finch %>%
group_by(Year) %>%
sample_n(size = 3) %>%
pander()
t.test(Depth ~ Year, data = finch)
?t.test
t.test(Depth ~ Year, data = finch, mu = 0, alternative = 'less')
t.test(Depth ~ Year, data = finch, paired = T
mu = 0, alternative = 'less')
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less')
t.test(Depth ~ Year, data = finch, paired = T)
swim
swim_long <- swim %>%
transmute(swimmer = swimmer,
body = body.suit.velocity,
swim = swim.suit.velocity) %>%
pivot_longer(c(body, swim),
names_to = 'suit',
values_to = 'velocity') %>%
head(5) %>%
pander()
swim_long <- swim %>%
transmute(swimmer = swimmer,
body = body.suit.velocity,
swim = swim.suit.velocity) %>%
pivot_longer(c(body, swim),
names_to = 'suit',
values_to = 'velocity')
library(tidyverse)
library(oibiostat)
library(Sleuth3)
library(pander)
data(swim)
swim <- swim %>%
transmute(swimmer = swimmer.number,
body.suit.velocity = wet.suit.velocity,
swim.suit.velocity = swim.suit.velocity)
swim %>% head(3) %>% pander()
diffs <- swim$body.suit.velocity - swim$swim.suit.velocity
swim$velocity.diff <- diffs
swim %>% head(3) %>% pander
# test for paired difference
t.test(diffs, mu = 0, alternative = 'greater')
swim_long <- swim %>%
transmute(swimmer = swimmer,
body = body.suit.velocity,
swim = swim.suit.velocity) %>%
pivot_longer(c(body, swim),
names_to = 'suit',
values_to = 'velocity')
swim_long %>%
head(5) %>%
pander()
t.test(Pair(velocity, swimmer) ~ suit, data = swim_long)
t.test(Pair(velocity, swimmer) ~ suit, data = swim_long, alternative = 'less')
t.test(Pair(velocity, swimmer) ~ suit, data = swim_long, alternative = 'greater')
t.test(Pair(swimmer, velocity) ~ suit, data = swim_long, alternative = 'greater')
t.test(velocity ~ pair(suit, swimmer), data = swim_long, alternative = 'greater')
t.test(velocity ~ Pair(suit, swimmer), data = swim_long, alternative = 'greater')
t.test(Pair(velocity, swimmer) ~ suit, data = swim_long, alternative = 'greater')
t.test(Pair(velocity, swimmer) ~ suit, data = swim_long, alternative = 'greater', paired = T)
t.test(Pair(body.suit.velocity, swim.suit.velocity) ~ 1, data = swim)
t.test(Pair(body.suit.velocity, swim.suit.velocity) ~ 1, data = swim, alternative = 'less')
t.test(Pair(body.suit.velocity, swim.suit.velocity) ~ 1, data = swim, alternative = 'greater')
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less')
finch %>% group_by(Year) %>% summarize(sd(Depth))
# two-sample test
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less',
var.equal = T)
# two-sample test
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less',
var.equal = F)
# two-sample test
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less',
var.equal = T)
# two-sample test
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less')
# two-sample test
out <- t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less')
out$stderr
summary(out)
out$statistic
out$method
out$estimate
out$alternative
out$df
summary(out)
out$estimate
out
# two-sample test
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less')$std
# two-sample test
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less', var.equal = T)$std
# two-sample test
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less')
# two-sample test
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less', var.equal = T)
# two-sample test
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less', var.equal = F)
# two-sample test
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less', var.equal = T)
# two-sample test
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less', var.equal = F)
finch %>% group_by(Year) %>% summarize(sd = sd(Depth))
finch %>% group_by(Year) %>% summarize(sd = sd(Depth), n = n())
finch %>% group_by(Year) %>% summarize(sd = sd(Depth), n = n()) %>% mutate(se = sd/sqrt(n))
finch %>% group_by(Year) %>% summarize(sd = sd(Depth), n = n()) %>% mutate(se = sd/sqrt(n)) %>% pull(se)
finch %>% group_by(Year) %>% summarize(sd = sd(Depth), n = n()) %>% mutate(se = sd^2/n) %>% pull(se)
finch %>% group_by(Year) %>% summarize(sd = sd(Depth), n = n()) %>% mutate(se = sd^2/n) %>% pull(se) %>% sum() %>% sqrt9)
finch %>% group_by(Year) %>% summarize(sd = sd(Depth), n = n()) %>% mutate(se = sd^2/n) %>% pull(se) %>% sum() %>% sqrt()
out$stderr
depth76 <- filter(finch, Year == 1976) %>% pull(Depth)
depth76
depth78 <- filter(finch, Year == 1978) %>% pull(Depth)
# two-sample test (formula inputs)
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less')
9.469663      -    10.138202
out <- t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less')
out
out$std
round(out$std, 4)
out$estimate
out$estimate %>% diff()
case0301
cloud <- case0301
cloud %>%
group_by(Treatment) %>%
sample_n(size = 2) %>%
pander
?case0301
cloud <- case0301 %>% rename_with(tolower)
cloud %>%
group_by(Treatment) %>%
sample_n(size = 2) %>%
pander()
cloud %>%
group_by(treatment) %>%
sample_n(size = 2) %>%
pander()
cloud %>% group_by(treatment) %>% summarize(sd = sd(rainfall))
sleep
?sleep
rename(sleep, extra.sleep = extra, drug = group, id = ID) %>%
group_by(group, id) %>%
sample_n(size = 4) %>%
pander()
rename(sleep, extra.sleep = extra, drug = group, id = ID) %>%
group_by(drug, id) %>%
sample_n(size = 4) %>%
pander()
rename(sleep, extra.sleep = extra, drug = group, id = ID) %>%
group_by(drug, id)
rename(sleep, extra.sleep = extra, drug = group, id = ID) %>%
group_by(id) %>%
sample_n(size = 4) %>%
pander()
rename(sleep, extra.sleep = extra, drug = group, id = ID) %>%
group_by(id)
rename(sleep, extra.sleep = extra, drug = group, subject = ID) %>%
group_by(subject) %>%
sample_n(size = 1) %>%
pander()
rename(sleep, extra.sleep = extra, drug = group, subject = ID) %>%
arrange(subject) %>%
slice_head(n = 6) %>%
pander()
sleep
t.test(Pair(extra, ID) ~ group, data = sleep)
t.test(Pair(extra, ID) ~ group, data = sleep, paired = T)
sleep %>% group_by(group)
cloud
cloud %>% group_by(treatment) %>% summarize(sd = sd(rainfall))
t.test(rainfall ~ treatment, var.equal = T, alternative = 'greater', data = cloud)
t.test(rainfall ~ treatment, var.equal = F, alternative = 'greater', data = cloud)
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less',
var.equal = T)
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less',
var.equal = F)
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less',
var.equal = F)$t
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less',
var.equal = F)$stat
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less',
var.equal = T)$stat
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less',
var.equal = T)$std
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less',
var.equal = F)$std
ex0112
?ex0112
cloud
case0112
library(Sleuth3)
case0112
ex0112
t.test(BP ~ Diet, data = ex0112, mu = 0, alternative = 'two.sided')
t.test(BP ~ Diet, data = ex0112,
mu = 0, alternative = 'two.sided',
var.equal = F)
t.test(BP ~ Diet, data = ex0112,
mu = 0, alternative = 'two.sided',
var.equal = T)
?hist
t.test(rexp(10, rate = 3), mu = 3)
t.test(rexp(10, rate = 3), mu = 1/3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
curve(dexp(x, rate = 1/3), from = 0, to = 5)
curve(dexp(x, rate = 3), from = 0, to = 5)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/3), mu = 3)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
t.test(rexp(10, rate = 1/10), rexp(5, rate = 1/10), mu = 0)
sim_out <- sapply(1:10000, function(i){t.test(rexp(7, rate = 1/10), mu = 10)$p.value})
sim_out
hist(sim_out)
hist(sim_out, breaks = 100)
mean(sim_out < 0.05)
ex0112
library(tidyverse)
library(oibiostat)
library(Sleuth3)
library(pander)
data(swim)
swim <- swim %>%
transmute(swimmer = swimmer.number,
body.suit.velocity = wet.suit.velocity,
swim.suit.velocity = swim.suit.velocity)
swim %>% head(3) %>% pander()
diffs <- swim$body.suit.velocity - swim$swim.suit.velocity
swim$velocity.diff <- diffs
swim %>% head(3) %>% pander
# test for paired difference
t.test(diffs, mu = 0, alternative = 'greater')
swim_long <- swim %>%
transmute(swimmer = swimmer,
body = body.suit.velocity,
swim = swim.suit.velocity) %>%
pivot_longer(c(body, swim),
names_to = 'suit',
values_to = 'velocity')
swim_long %>%
head(5) %>%
pander()
data(famuss)
head(famuss, 3) %>% pander()
finch <- case0201
finch %>%
group_by(Year) %>%
sample_n(size = 3) %>%
pander()
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less')
depth76 <- filter(finch, Year == 1976) %>% pull(Depth)
depth78 <- filter(finch, Year == 1978) %>% pull(Depth)
# two-sample test (formula inputs)
t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less')
# two-sample test (vector inputs)
t.test(depth76, depth78,
mu = 0, alternative = 'less')
out <- t.test(Depth ~ Year, data = finch,
mu = 0, alternative = 'less')
out
cloud <- case0301 %>% rename_with(tolower)
cloud %>%
group_by(treatment) %>%
sample_n(size = 4) %>%
pander()
rename(sleep, extra.sleep = extra, drug = group, subject = ID) %>%
arrange(subject) %>%
slice_head(n = 6) %>%
pander()
ex0112
?ex0112
diets <- ex0112
diets
boxplot(BP ~ Diet, data = diets)
ggplot(diet, aes(x = BP)) + geom_histogram() + facet_wrap(~Diet)
ggplot(diets, aes(x = BP)) + geom_histogram() + facet_wrap(~Diet)
ggplot(diets, aes(x = BP)) + geom_histogram(bins = 3) + facet_wrap(~Diet)
head(diets)
pander(diets)
t.test(BP ~ Diet, data = diets,
mu = 0, alternative = 'two.sided',
var.equal = F)
t.test(BP ~ Diet, data = ex0112,
mu = 0, alternative = 'two.sided',
var.equal = F)
t.test(BP ~ Diet, data = diets,
mu = 0, alternative = 'two.sided',
var.equal = F)
t.test(BP ~ Diet, data = ex0112,
mu = 0, alternative = 'two.sided',
var.equal = F)
t.test(BP ~ Diet, data = ex0112,
mu = 0, alternative = 'two.sided',
var.equal = T)
# equal variance test
t.test(BP ~ Diet, data = ex0112,
mu = 0, alternative = 'two.sided',
var.equal = T)$std.err
# equal variance test
t.test(BP ~ Diet, data = ex0112,
mu = 0, alternative = 'two.sided',
var.equal = T)$std.error
# equal variance test
t.test(BP ~ Diet, data = ex0112,
mu = 0, alternative = 'two.sided',
var.equal = T)$std
# unequal variance test
t.test(BP ~ Diet, data = diets,
mu = 0, alternative = 'two.sided',
var.equal = F)$std
diets %>% group_by(Diet) %>% summarize(mean(BP))
diets %>% group_by(Diet) %>% summarize(sd = sd(BP), = n())
diets %>% group_by(Diet) %>% summarize(sd = sd(BP), n = n())
diets %>% group_by(Diet) %>% summarize(sd = sd(BP), n = n()) %>% mutate(se = sd^2/n)
cloud
cloud %>% ggplot(aes(x = rainfall)) + geom_histogram(bins = 10) + facet_wrap(~treatment)
clout %>% group_by(treatment) %>% summarize(sd = sd(rainfall))
cloud %>% group_by(treatment) %>% summarize(sd = sd(rainfall))
power.t.test(delta = 0.5, power = 0.9)
power.t.test(power = 0.95, delta = 0.5, sig.level = 0.05, type = 'two.sample', alternative = 'two.sided')
power.t.test(power = 0.95, # 1 minus type II error rate
delta = 0.5, # true mean difference to detect
sig.level = 0.05, # significance level of test
type = 'two.sample', # type of test
alternative = 'two.sided') # direction of alternative
power.t.test(n = 7, delta = 1)
power.t.test(power = 0.95,
delta = 0.5,
sig.level = 0.01,
type = 'two.sample',
alternative = 'two.sided')
power.t.test(power = 0.95,
delta = 0.5,
sig.level = 0.05,
type = 'two.sample',
alternative = 'two.sided')
library(oibiostat)
library(Sleuth3)
data(swim)
data(famuss)
finch <- case0201
finch
# compute difference wetsuit - swimsuit
velocity.diff <- swim$wet.suit.velocity - swim$swim.suit.velocity
library(oibiostat)
library(Sleuth3)
data(swim)
data(famuss)
finch <- case0201
# compute difference wetsuit - swimsuit
velocity.diff <- swim$wet.suit.velocity - swim$swim.suit.velocity
# perform t test
t.test(velocity.diff, mu = 0, alternative = 'greater')
t.test(Depth ~ Year, data = finch, mu = 0, alternative = 'less')
diets <- ex0112
sleep
data(sleep)
sleep
library(oibiostat)
library(Sleuth3)
data(swim)
data(famuss)
data(sleep)
finch <- case0201
diets <- ex0112
# examine data; note that grouping is shown as a variable
head(finch)
# inspect data
head(diets)
?ex0112
?case0301
head(cloud)
library(oibiostat)
library(Sleuth3)
data(swim)
data(famuss)
data(sleep)
finch <- case0201
diets <- ex0112
# step 1: compute difference wetsuit - swimsuit
velocity.diff <- swim$wet.suit.velocity - swim$swim.suit.velocity
# step 2: perform one-sample t test
t.test(velocity.diff, mu = 0, alternative = 'greater')
# examine data; note that grouping is shown as a variable
head(finch)
# perform t test
t.test(Depth ~ Year, data = finch, mu = 0, alternative = 'less')
cloud <- case0301
head(cloud)
sleep
sleep
sort(sleep)
dplyr::arrange(sleep, ID)
dplyr::arrange(sleep, ID) |> head()
### Sleep data
knitr::purl('content/labs/lab8-twosample.qmd', 'content/labs/lab8-twosample.R')
