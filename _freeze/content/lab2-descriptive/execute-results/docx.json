{
  "hash": "2218289d1e8a054ba54f8ee5fbb21e8f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lab 2: Descriptive statistics and simple graphics\"\nauthor: \"STAT218\"\nauthor-title: \"Course activity\"\nexecute: \n  message: false\n  warning: false\nformat: \n  html:\n    fig-width: 5\n    fig-height: 4\n    fig-align: 'center'\n    toc: true\n  docx:\n    toc: false\nprefer-html: true\nembed-resources: true\n---\n\n\n\nThe objectives of this lab are to learn to:\n\n-   make basic statistical graphics for visualizing frequency distributions\n-   compute common measures of location and spread\n-   discern appropriate measures of location and spread based on presence of outliers and skewness\n\nWe'll use the FAMuSS dataset, as in lecture.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\n# load famuss dataset \nload('data/famuss.RData')\n\n# inspect data frame\nhead(famuss)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 9\n  ndrm.ch drm.ch sex      age race      height weight genotype   bmi\n    <dbl>  <dbl> <fct>  <int> <fct>      <dbl>  <dbl> <fct>    <dbl>\n1      40     40 Female    27 Caucasian   65      199 CC        33.1\n2      25      0 Male      36 Caucasian   71.7    189 CT        25.8\n3      40      0 Female    24 Caucasian   65      134 CT        22.3\n4     125      0 Female    40 Caucasian   68      171 CT        26.0\n5      40     20 Female    32 Caucasian   61      118 CC        22.3\n6      75      0 Female    24 Hispanic    62.2    120 CT        21.8\n```\n\n\n:::\n:::\n\n\n\nAs a quick refresher, you can extract a vector of the observations for any particular variable from the dataframe as follows: `famuss$[variable name]`.\n\nWhile not strictly necessary, I recommend retrieving and storing the variable(s) you'll use as separate objects, at least while you're still a beginner. For example:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# extract the age variable\nfamuss$age\n\n# store the age column as a vector\nage <- famuss$age\n```\n:::\n\n\n\n### Basic statistical graphics\n\n#### Categorical variables\n\nFor categorical variables, as you saw in the last lab, `table(...)` will tabulate counts of the number of occurrences of each unique values of a categorical variable. The result can be passed to `barplot(...)` for a simple **barplot** to visualize the frequency distribution:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# retrieve genotype\ngenotype <- famuss$genotype\n\n# make a table, generate a barplot\ntable(genotype) |> barplot()\n```\n\n::: {.cell-output-display}\n![](lab2-descriptive_files/figure-docx/barplots-1.png)\n:::\n:::\n\n\n\n::: callout-tip\n## Your turn\n\nMake a barplot to visualize the frequency distribution of racial groups in the FAMuSS study.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# retrieve race\n\n# make a table, generate a barplot\n```\n:::\n\n\n:::\n\n#### Numerical variables\n\nIf a numeric variable is discrete without too many values, the frequency distribution could be visualized without any binning as a barplot. However, this is **not recommended** because it will result in a plot that is not scaled properly.\n\nInstead, it is better to make a histogram with one bin per unique possible value; this will scale the axis properly. However, it is also acceptable to make a histogram with binning that will result in aggregating some values. Both are shown below.\n\nThe approximate number of bins, and thus the amount of aggregation, is controlled by the argument `breaks = ...`:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# retrieve age\nage <- famuss$age\n\n# effectively, a bar plot of ages\nhist(age, breaks = 25)\n```\n\n::: {.cell-output-display}\n![](lab2-descriptive_files/figure-docx/histograms-1.png)\n:::\n\n```{.r .cell-code}\n# fewer bins\nhist(age, breaks = 10)\n```\n\n::: {.cell-output-display}\n![](lab2-descriptive_files/figure-docx/histograms-2.png)\n:::\n:::\n\n\n\nFor continuous variables, binning is a necessity. The second plot is better, because it shows the shape more clearly without obscuring too much detail.\n\n::: callout-note\n## Your turn\n\nMake a histogram of percent change in dominant arm strength. Experiment to see how the shape of the distribution appears at various binning resolutions; then pick a number of breaks that you feel reflects the data best.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# retrieve dominant arm percent change\n\n# make a histogram; find a binning that captures the shape well\n```\n:::\n\n\n:::\n\nTo store a graphic as a separate file for use in other documents, find the 'export' icon in the plot panel and select the 'Save as image' option; then follow prompts. Try this for the plot you just made.\n\n### Descriptive statistics\n\nIn class we discussed several descriptive statistics for numeric variables. These statistics are so commonly used that they have their own functions in R.\n\n#### Measures of location\n\nThe following functions return common measures of location for numeric variables:\n\n-   `mean(...)` returns an average\n-   `median(...)` returns a median\n-   `quantile(...)` returns a quantile\n-   `min(...)` and `max(...)` return a minimum and a maximum, respectively\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# average age\nmean(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 24.40168\n```\n\n\n:::\n\n```{.r .cell-code}\n# median age (middle value)\nmedian(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 22\n```\n\n\n:::\n\n```{.r .cell-code}\n# 25th percentile of age (\"quantile\" is another term for percentile)\nquantile(age, probs = 0.25)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n25% \n 20 \n```\n\n\n:::\n\n```{.r .cell-code}\n# 25th *and* 75th percentile of age\nquantile(age, probs = c(0.25, 0.75))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n25% 75% \n 20  27 \n```\n\n\n:::\n\n```{.r .cell-code}\n# minimum age\nmin(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 17\n```\n\n\n:::\n\n```{.r .cell-code}\n# maximum age\nmax(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 40\n```\n\n\n:::\n:::\n\n\n\nNotice how the `probs = ...` argument to the `quantile()` function, which specifies *which* percentile R will calculate, can be used to calculate multiple percentiles at once.\n\nIf you want to inspect *all* of the location measures above (the five-number summary plus the mean) the `summary(...)` function will do just that.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# all common location measures\nsummary(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   17.0    20.0    22.0    24.4    27.0    40.0 \n```\n\n\n:::\n:::\n\n\n\n::: callout-note\n## Your turn\n\nTry computing the location measures above for percent change in dominant arm strength. Compare the mean and median. What does the comparison tell you about the skewness of this variable? Is this consistent with the histogram from the previous 'your turn'?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# compute the five-number summary for change in dominant arm strength\n```\n:::\n\n\n:::\n\n#### Measures of spread\n\nThe following functions return common measures of spread for numeric variables:\n\n-   `range(...)` returns the range (min, max)\n-   `IQR(...)` returns the interquartile range (middle 50% of data)\n-   `var(...)` returns the variance (average squared deviations from mean)\n-   `sd(...)` returns the standard deviation (variance, on original scale)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# age range\nrange(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 17 40\n```\n\n\n:::\n\n```{.r .cell-code}\n# interquartile range of ages (width of interval containing middle 50% of data)\nIQR(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7\n```\n\n\n:::\n\n```{.r .cell-code}\n# variance of age\nvar(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 33.79966\n```\n\n\n:::\n\n```{.r .cell-code}\n# standard deviation of age\nsd(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 5.813748\n```\n\n\n:::\n:::\n\n\n\n::: callout-note\n## Your turn\n\nCompute the standard deviation of percent change in dominant arm strength.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# standard deviation of percent change in dominant arm strength\n```\n:::\n\n\n\nInterpret the value in context.\n:::\n\n#### Robustness\n\nWhen would you use median instead of mean? IQR instead of standard deviation? The answer has to do with **robustness**, which in statistics means sensitivity to outliers or extreme values.\n\nTo explore this idea, recall first the actual mean and median ages for the participants in the FAMuSS study as well as the age range:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# average age\nmean(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 24.40168\n```\n\n\n:::\n\n```{.r .cell-code}\n# median age\nmedian(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 22\n```\n\n\n:::\n\n```{.r .cell-code}\n# range\nrange(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 17 40\n```\n\n\n:::\n:::\n\n\n\nNow let's add an artificial outlier -- a few hypothetical participant who are in their 80's and 90's -- and compute the measures of location again:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# average age\nmean(c(age, 96, 92, 87, 91))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 24.84975\n```\n\n\n:::\n\n```{.r .cell-code}\n# median age\nmedian(c(age, 96, 92, 87, 91))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 22\n```\n\n\n:::\n:::\n\n\n\nThe mean increases while the median does not. More broadly, statistics based on percentiles are in general insensitive to outliers, unless there's a large group of outlying observations. In this sense they are robust statistics.\n\nA similar difference can be observed between deviation-based measures and interquartile range. The original measures were:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# variance of ages\nvar(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 33.79966\n```\n\n\n:::\n\n```{.r .cell-code}\n# interquartile range of ages\nIQR(age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7\n```\n\n\n:::\n:::\n\n\n\nNow adding in our artificial outliers:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# age variance\nvar(c(age, 96, 92, 87, 91))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 63.55598\n```\n\n\n:::\n\n```{.r .cell-code}\n# age iqr\nIQR(c(age, 96, 92, 87, 91))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7\n```\n\n\n:::\n:::\n\n\n\n### Grouped summaries\n\nWhat if you wish to find the mean percent change in dominant arm strength *separately* for each genotype?\n\nThe `tidyverse` package loaded at the outset has a pair of functions, `group_by` and `summarize`, that allow you to do this efficiently. The steps are:\n\n1.  Start with the *data frame* `famuss`\n2.  `group by` the genotype variable\n3.  `summarize`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# average dominant arm change by genotype\nfamuss |>\n  group_by(genotype) |>\n  summarize(avg.drm.ch = mean(drm.ch))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 2\n  genotype avg.drm.ch\n  <fct>         <dbl>\n1 CC            10.7 \n2 CT             8.49\n3 TT            13.0 \n```\n\n\n:::\n:::\n\n\n\nThe `summarize` function can actually compute multiple summaries: each argument should specify a name for the summary and the calculation to perform in the format `<NAME> = <FUNCTION>(<COLUMN NAME>)`:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# average dominant and nondominant arm change by genotype\nfamuss |>\n  group_by(genotype) |>\n  summarize(avg.drm.ch = mean(drm.ch),\n            avg.ndrm.ch = mean(ndrm.ch))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  genotype avg.drm.ch avg.ndrm.ch\n  <fct>         <dbl>       <dbl>\n1 CC            10.7         48.9\n2 CT             8.49        53.2\n3 TT            13.0         58.1\n```\n\n\n:::\n:::\n\n\n\n::: callout-note\n## Your turn\n\nCalculate the median percent change in dominant arm strength separately for each genotype by modifying the first example above.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# median percent change in dominant arm strength by genotype\n```\n:::\n\n\n:::\n\n### Practice problems\n\nThese problems may look lengthy at face value, but the calculations are rather brief. A suggestion is: determine which calculations are required for each part and focus on doing those calculations first; then look back over your results to interpret them and answer the prompts.\n\n1.  \\[L3\\] Use the `census` data again from the previous problem set and carry out the following descriptive summaries.\n\n    a.  Make a histogram of total personal income. Choose the binning so as to capture the shape well but not obscure too much detail. Are there outliers?\n    b.  Compute the mean and five-number summary of total personal income. Which measure of location is most appropriate and why?\n    c.  Compute the interquartile range and standard deviation of total personal income and interpret them in context. Which measure is more appropriate and why?\n    d.  Compute the median total personal income separately for men and women.\n\n\n\n::: {.cell}\n\n:::\n\n\n\n2.  \\[L3\\] Data from *Chen, W., et al., Maternal investment increases with altitude in a frog on the Tibetan Plateau. Journal of Evolutionary Biology 26-12 (2013)* includes measurements pertaining to egg clutches of several populations of frog at breeding ponds (sites) in the eastern Tibetan Plateau.\n\n    a.  How many samples were collected at each site?\n    b.  Compute the frequency distribution of site altitudes among samples collected in the study.\n    c.  Make a barplot of the frequency distribution from (a). Are samples collected more or less uniformily across altitudes? If not, which altitudes are most represented in the sample?\n    d.  Make a histogram of clutch volumes. Describe the shape and number of modes.\n    e.  Calculate the mean and five-number summary of clutch volume.\n    f.  Calculate and interpret the standard deviation, variance, and interquartile range.\n    g.  Calculate the average clutch volume *separately* for each altitude. Does average clutch volume seem to differ by altitude?\n    h.  \\[optional\\] Devise a way to calculate the average absolute deviation.\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "lab2-descriptive_files/figure-docx"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}