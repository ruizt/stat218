<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.550">

  <title>STAT218 - Nonparametric inference</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-H3YKZX4J88"></script>

  <script type="text/javascript">

  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-H3YKZX4J88', { 'anonymize_ip': true});
  </script>
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Nonparametric inference</h1>
  <p class="subtitle">Alternatives to one- and two-sample <em>t</em> tests</p>

<div class="quarto-title-authors">
</div>

</section>
<section id="todays-agenda" class="slide level2">
<h2>Today’s agenda</h2>
<ol type="1">
<li>[lecture] One- and two-sample inference using ranks</li>
<li>[lecture] Permutation tests</li>
<li>[lab] Three applications of nonparametric tests</li>
</ol>
</section>
<section id="remark" class="slide level2">
<h2>Remark</h2>
<blockquote>
<p>Avoid over-interpreting one summary/graphic by checking alternatives</p>
</blockquote>
<div class="columns">
<div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week7-nonparametric_files/figure-revealjs/unnamed-chunk-2-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>common error: “republicans had larger households”</li>
</ul>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week7-nonparametric_files/figure-revealjs/unnamed-chunk-3-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="parametric-inference" class="slide level2">
<h2>Parametric inference</h2>
<p>Recall the basis for our inferential procedures (intervals/tests) so far:</p>
<blockquote>
<p>the <span class="math inline">\(t\)</span> model approximates the sampling distribution of the <span class="math inline">\(T\)</span> statistic(s)</p>
</blockquote>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week7-nonparametric_files/figure-revealjs/unnamed-chunk-4-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>This is an example of a <strong>parametric</strong> approach: it relies on a <strong>distributional assumption</strong>.</p>
<ul>
<li>the <em>t</em> model is parametric distribution</li>
<li><span class="math inline">\(T\)</span> exactly follows this model only when underlying population distribution(s) are normal</li>
</ul>
<p><em>What should be done if the assumption is not plausible?</em></p>
<!-- This relies on some underlying assumptions: -->
<!-- - observations are independent -->
<!-- - either... -->
<!--     + sample sizes are "large enough"  -->
<!--     + or population distributions are nearly normal -->
</div>
</div>
</section>
<section id="nonparametric-procedures" class="slide level2">
<h2>Nonparametric procedures</h2>
<p>Nonparametric procedures are <strong>distribution-free</strong> in the sense that they make no assumptions about the <em>specific form</em> of the underlying population distribution.</p>
<blockquote>
<p>This does <em>not</em> mean nonparametric methods are free of any assumptions whatsoever</p>
</blockquote>
<p>Nonparametrics can provide useful alternatives in special circumstances:</p>
<ul>
<li>parametric assumptions not plausible</li>
<li>inferences about population parameters besides means</li>
<li>small-sample settings</li>
<li>‘narrow’ inferences limited in scope to observed data rather than a population</li>
</ul>
<p>We will cover two nonparametric approaches to one- and two-sample inference:</p>
<ol type="1">
<li>Rank-based procedures</li>
<li>Permutation procedures</li>
</ol>
</section>
<section id="rank-based-procedures" class="slide level2">
<h2>Rank-based procedures</h2>
<blockquote>
<p><strong>Rank-based procedures</strong> are inferential procedures that leverage sorted data and distributional symmetry or group exchangeability assumptions to test for location shifts.</p>
</blockquote>
<p>Consider the DDT data (15 measurements of DDT in kale in ppm) again. Sorted:</p>
<div class="cell">
<div class="cell-output-display">
<p><em>2.79</em>, <em>2.93</em>, <em>3.06</em>, <em>3.07</em>, <em>3.08</em>, <em>3.18</em>, <em>3.22</em>, <em>3.22</em>, <em>3.33</em>, <em>3.34</em>, <em>3.34</em>, <em>3.38</em>, <em>3.56</em>, <em>3.78</em> and <em>4.64</em></p>
</div>
</div>
<p>Suppose you wish to test whether the ‘center’ is 3ppm. If you assume the population distribution is symmetric about <em>c</em>…</p>
<ol type="1">
<li>How many observations would you expect to be smaller than <em>c</em>?</li>
<li>How many observations are actually smaller than 3?</li>
<li>Based on your answers to 1-2, do you think it is likely that <em>c = 3</em>?</li>
</ol>
</section>
<section id="signed-rank-test" class="slide level2">
<h2>Signed rank test</h2>
<blockquote>
<p>The <strong>signed rank test</strong> is an alternative to the one-sample <em>t</em> test that <em>assumes the population distribution is symmetric</em> to test hypotheses about its center <em>c</em>.</p>
</blockquote>
<div class="columns">
<div class="column" style="width:60%;">
<p>Hypotheses: <span class="math display">\[H_0: c = c_0 \quad\text{vs.}\quad H_A: c \mathrel{\substack{&lt;\\\neq\\ &gt;}} c_0\]</span> Procedure:</p>
<ol type="1">
<li><p>[center] Calculate deviations <span class="math inline">\(d_i = x_i - c_0\)</span></p></li>
<li><p>[rank] Sort and rank the absolute deviations <span class="math inline">\(|d_i|\)</span></p>
<ul>
<li>average ranks in case of ties</li>
<li>drop zeros</li>
</ul></li>
<li><p>[sum] Add up the ‘signed ranks’ <span class="math inline">\(\text{sign}(d_i) \times R_i\)</span></p></li>
</ol>
</div><div class="column" style="width:40%;">
<p>This produces the test statistic:</p>
<p><span class="math display">\[V = \sum_{i = 1}^n \text{sign}(d_i) \times R_i\]</span></p>
<p>Sampling distribution found using:</p>
<ul>
<li>(exact) combinatorics</li>
<li>(approximate) probability theory</li>
</ul>
<p>Reject if <span class="math inline">\(V\)</span> is sufficiently large in the direction of the alternative.</p>
</div>
</div>
</section>
<section id="illustration-ddt-data" class="slide level2">
<h2>Illustration: DDT data</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>Signed rank calculations:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 4
   obs.num   ddt   ddt.c signed.rank
     &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;
 1      10  3.06  0.0600         1  
 2       2  2.93 -0.0700        -2.5
 3      11  3.07  0.0700         2.5
 4      13  3.08  0.0800         4  
 5       7  3.18  0.180          5  
 6       1  2.79 -0.21          -6  
 7       3  3.22  0.220          7.5
 8       5  3.22  0.220          7.5
 9       8  3.33  0.33           9  
10       9  3.34  0.34          10.5
11      15  3.34  0.34          10.5
12       6  3.38  0.38          12  
13      12  3.56  0.56          13  
14       4  3.78  0.78          14  
15      14  4.64  1.64          15  </code></pre>
</div>
</div>
<p>Procedure:</p>
<ol type="1">
<li><strong>Center</strong> observations</li>
<li><strong>Rank</strong> absolute deviations</li>
<li><strong>Sum</strong> signed ranks</li>
</ol>
</div><div class="column" style="width:60%;">
<p>Hypotheses:</p>
<p><span class="math display">\[H_0: c = 3 \quad\text{vs}\quad H_A: c &gt; 3\]</span></p>
<p>Test statistic:</p>
<div class="cell">
<div class="cell-output-display">
<table style="width:26%;">
<colgroup>
<col style="width: 15%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">sign</th>
<th style="text-align: center;">sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">negative</td>
<td style="text-align: center;">-8.5</td>
</tr>
<tr class="even">
<td style="text-align: center;">positive</td>
<td style="text-align: center;">111.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">103</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>There are <em>32768</em> possible sign combinations; of these, only about 0.18% give a larger value of <span class="math inline">\(V\)</span>.</p>
<blockquote>
<p><span class="math inline">\(p = 0.0018 &lt; 0.05 \;\Rightarrow\; \text{reject } H_0\)</span></p>
</blockquote>
</div>
</div>
</section>
<section id="signed-rank-test-in-r" class="slide level2">
<h2>Signed rank test in R</h2>
<p>The implementation in R looks and functions much like <code>t.test</code>:</p>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="co"># signed rank test</span></span>
<span id="cb2-2"><a></a><span class="fu">wilcox.test</span>(ddt, <span class="at">mu =</span> <span class="dv">3</span>, </span>
<span id="cb2-3"><a></a>            <span class="at">alternative =</span> <span class="st">'greater'</span>,</span>
<span id="cb2-4"><a></a>            <span class="at">conf.int =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  ddt
V = 111.5, p-value = 0.001876
alternative hypothesis: true location is greater than 3
95 percent confidence interval:
 3.135002      Inf
sample estimates:
(pseudo)median 
       3.26001 </code></pre>
</div>
</div>
<ul>
<li>reports the sum of <em>positive</em> signed ranks</li>
<li><span class="math inline">\(p\)</span> value is approximate with ties or zeros</li>
<li>pseudo-median (<span class="math inline">\(\neq\)</span> median) is a measure of center</li>
</ul>
</div><div class="column">
<p>The technically accurate interpretation is given in terms of “center”:</p>
<blockquote>
<p>The data provide strong evidence against the null hypothesis that the center of the distribution of DDT in kale is 3ppm in favor of the alternative hypothesis that the center exceeds 3ppm (signed rank test, <em>p = 0.001876</em>).</p>
</blockquote>
<!-- - the minimum $p$ value is $\frac{1}{\#\;\text{sign combinations}}$ = 0.00003052 (depends on sample size) -->
</div>
</div>
</section>
<section id="minimum-p-values" class="slide level2">
<h2>Minimum <span class="math inline">\(p\)</span> values</h2>
<p>The <span class="math inline">\(p\)</span> value for the test is the proportion of all possible sign combinations that yield a <span class="math inline">\(V\)</span> larger/smaller than observed.</p>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week7-nonparametric_files/figure-revealjs/unnamed-chunk-9-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:40%;">
<ul>
<li>fewer sign combinations for few observations</li>
<li>smallest possible <span class="math inline">\(p\)</span> value depends on sample size</li>
<li>don’t expect small p-values in small-<span class="math inline">\(n\)</span> settings</li>
</ul>
</div>
</div>
</section>
<section id="paired-differences" class="slide level2">
<h2>Paired differences</h2>
<blockquote>
<p>For paired differences, the signed rank test tests for a difference in location between the groups.</p>
</blockquote>
<p>The test assumes that both population distributions are symmetric and tests the hypotheses:</p>
<p><span class="math display">\[H_0: c_1 = c_2 \quad\text{vs}\quad H_A: c_1 \mathrel{\substack{&lt;\\\neq\\ &gt;}} c_2\]</span></p>
<ul>
<li><span class="math inline">\(c_1\)</span> is the center of group/population 1</li>
<li><span class="math inline">\(c_2\)</span> is the center of group/population 2</li>
</ul>
</section>
<section id="paired-difference-example" class="slide level2">
<h2>Paired difference example</h2>
<div class="columns">
<div class="column" style="width:50%;">
<blockquote>
<p>Is drug 2 more effective than drug 1?</p>
</blockquote>
<p>First few observations of sleep data:</p>
<div class="cell">
<div class="cell-output-display">
<table style="width:40%;">
<colgroup>
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">ID</th>
<th style="text-align: center;">drug1</th>
<th style="text-align: center;">drug2</th>
<th style="text-align: center;">diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.7</td>
<td style="text-align: center;">1.9</td>
<td style="text-align: center;">-1.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">-1.6</td>
<td style="text-align: center;">0.8</td>
<td style="text-align: center;">-2.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">-0.2</td>
<td style="text-align: center;">1.1</td>
<td style="text-align: center;">-1.3</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">-1.2</td>
<td style="text-align: center;">0.1</td>
<td style="text-align: center;">-1.3</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The signed rank test will test for a difference in location, assuming that the pairwise differences are symmetric about some central point.</p>
</div><div class="column" style="width:50%;">
<p>Hypotheses:</p>
<p><span class="math display">\[\begin{cases} H_0: c_\text{drug1} = c_\text{drug2} \\
H_A: c_\text{drug1} &lt; c_\text{drug2}
\end{cases}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a><span class="fu">wilcox.test</span>(sleep.diffs, <span class="at">mu =</span> <span class="dv">0</span>,</span>
<span id="cb4-2"><a></a>            <span class="at">alternative =</span> <span class="st">'less'</span>,</span>
<span id="cb4-3"><a></a>            <span class="at">conf.int =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  sleep.diffs
V = 0, p-value = 0.004545
alternative hypothesis: true location is less than 0
95 percent confidence interval:
      -Inf -1.149967
sample estimates:
(pseudo)median 
     -1.400031 </code></pre>
</div>
</div>
<p><em>Aside: what does</em> <span class="math inline">\(V = 0\)</span> mean?</p>
</div>
</div>
</section>
<section id="checking-assumptions" class="slide level2">
<h2>Checking assumptions</h2>
<blockquote>
<p>For the signed rank test, the underlying distribution is assumed to be symmetric.</p>
</blockquote>
<p>Check the symmetry assumption graphically using histograms.</p>

<img data-src="week7-nonparametric_files/figure-revealjs/unnamed-chunk-12-1.png" width="576" class="r-stretch"><p>It can be tricky with small sample sizes; don’t be too sensitive to asymmetries. Both of these are acceptable.</p>
</section>
<section id="rank-sum-test" class="slide level2">
<h2>Rank sum test</h2>
<blockquote>
<p>The <strong>rank-sum test</strong> is a two-sample rank-based inference procedure that tests for a difference in location from independent samples.</p>
</blockquote>
<p><strong>Key idea:</strong> if observations in both groups come from the same population distribution, then they should be exchangeable (<em>i.e.</em>, groupings don’t matter).</p>
<div class="columns">
<div class="column">
<p>Assumptions:</p>
<ul>
<li>observations are independent</li>
<li>the populations differ only by location</li>
</ul>
<p>Hypotheses:</p>
<p><span class="math display">\[H_0: c_1 = c_2\quad\text{vs}\quad H_A: c_1 \mathrel{\substack{&lt;\\\neq\\&gt;}} c_2\]</span></p>
</div><div class="column">
<p>Procedure:</p>
<ol type="1">
<li>[pool] Combine observations from both groups</li>
<li>[rank] Sort and rank pooled observations</li>
<li>[sum] Add up ranks in the smaller group</li>
</ol>
<p>Reject if the sum is larger/smaller than expected.</p>
</div>
</div>
</section>
<section id="checking-assumptions-1" class="slide level2">
<h2>Checking assumptions</h2>
<blockquote>
<p>The assumption for the rank sum test is that the distributions differ only by location.</p>
</blockquote>
<p>If this is true, histograms should have the same shape and modes.</p>

<img data-src="week7-nonparametric_files/figure-revealjs/unnamed-chunk-13-1.png" width="864" class="r-stretch"><p>In all of these cases, there is a (true) difference in location.</p>
<ul>
<li>if shape differs too much, the rank sum test should <em>not</em> be used</li>
<li>can be hard to tell with small samples</li>
</ul>
</section>
<section id="your-turn" class="slide level2">
<h2>Your turn</h2>
<blockquote>
<p>Is the rank sum test appropriate for comparing centers?</p>
</blockquote>
<div class="columns">
<div class="column">
<p>Out-of-state tuition costs from 26 public and 26 private universities.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week7-nonparametric_files/figure-revealjs/unnamed-chunk-14-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<p>Deviations from expected cancer rates in CT in years with high and low sunspot activity.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week7-nonparametric_files/figure-revealjs/unnamed-chunk-15-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="rank-sum-test-in-r" class="slide level2">
<h2>Rank sum test in R</h2>
<p>The <code>wilcox.test</code> function also implements the rank sum test.</p>
<div class="columns">
<div class="column" style="width:55%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a><span class="fu">wilcox.test</span>(delta <span class="sc">~</span> sunspot.activity, <span class="at">data =</span> cancer, </span>
<span id="cb6-2"><a></a>            <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">alternative =</span> <span class="st">'greater'</span>, </span>
<span id="cb6-3"><a></a>            <span class="at">conf.int =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  delta by sunspot.activity
W = 270, p-value = 8.182e-06
alternative hypothesis: true location shift is greater than 0
95 percent confidence interval:
 0.2693557       Inf
sample estimates:
difference in location 
              0.455014 </code></pre>
</div>
</div>
<ul>
<li><p><span class="math inline">\(p\)</span>-value gives the percentage of possible rank allocations among the groups for which the rank sum is at least as favorable to <span class="math inline">\(H_A\)</span></p>
<ul>
<li>computed by combinatorics</li>
<li>subject to minima depending on sample sizes</li>
</ul></li>
</ul>
</div><div class="column" style="width:45%;">
<blockquote>
<p>The data provide strong evidence against the hypothesis that the distribution of deviations from expected cancer rates in Connecticut does not differ according to sunspot activity in favor of a positive location shift associated with high sunspot activity (rank sum test, <span class="math inline">\(p &lt; 0.0001\)</span>).</p>
</blockquote>
</div>
</div>
</section>
<section id="use-heuristics-for-rank-procedures" class="slide level2">
<h2>Use heuristics for rank procedures</h2>
<p>Consider a rank-based procedure if…</p>
<ul>
<li>sample sizes are small</li>
<li>you want to test for a location shift</li>
</ul>
<p>Once you’ve decided to consider a rank test…</p>
<ol type="1">
<li>Determine test type (one-sample, paired, two-sample)</li>
<li>Check symmetry/similarity assumption graphically</li>
<li>Perform test</li>
</ol>
</section>
<section id="permutation-tests" class="slide level2">
<h2>Permutation tests</h2>
<blockquote>
<p>Permutation tests are two-sample procedures that provide highly flexible alternatives to parametric tests based on exchangeability.</p>
</blockquote>
<p><strong>Key idea</strong>: if there is no difference between groups/populations, observations are <em>exchangeable</em> between groups.</p>
<div class="columns">
<div class="column">
<p>Procedure:</p>
<ol type="1">
<li>Randomly shuffle group assignments among the observations.</li>
<li>Calculate any group comparison.</li>
<li>Repeat many times.</li>
<li>Calculate proportion of shufflings for which the comparison is at least as large as the observed comparison in the direction of the alternative</li>
</ol>
</div><div class="column">
<p>Permutation tests for differences in means are implemented by <code>permTS()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a><span class="fu">permTS</span>(OutOfState <span class="sc">~</span> Type, <span class="at">data =</span> ex0332, </span>
<span id="cb8-2"><a></a>       <span class="at">alternative =</span> <span class="st">'greater'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Permutation Test using Asymptotic Approximation

data:  OutOfState by Type
Z = 3.0644, p-value = 0.001091
alternative hypothesis: true mean Type=Private - mean Type=Public is greater than 0
sample estimates:
mean Type=Private - mean Type=Public 
                            12219.08 </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="lab-three-end-to-end-analyses" class="slide level2">
<h2>Lab: three end-to-end analyses</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>Cholesterol data:</p>
<div class="cell">
<div class="cell-output-display">
<table style="width:33%;">
<colgroup>
<col style="width: 13%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Diet</th>
<th style="text-align: center;">Cholesterol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">CORNFLK</td>
<td style="text-align: center;">4.61</td>
</tr>
<tr class="even">
<td style="text-align: center;">OATBRAN</td>
<td style="text-align: center;">3.84</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Zinc and dietary supplements:</p>
<div class="cell">
<div class="cell-output-display">
<table style="width:22%;">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Group</th>
<th style="text-align: center;">Zinc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">1.31</td>
</tr>
<tr class="even">
<td style="text-align: center;">A</td>
<td style="text-align: center;">1.45</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Sleep data:</p>
<div class="cell">
<div class="cell-output-display">
<table style="width:35%;">
<colgroup>
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">ID</th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.7</td>
<td style="text-align: center;">1.9</td>
<td style="text-align: center;">-1.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">-1.6</td>
<td style="text-align: center;">0.8</td>
<td style="text-align: center;">-2.4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column" style="width:60%;">
<p>Questions:</p>
<ol type="1">
<li><p>Are zinc concentrations (mg/ml) in the blood of rats lower among those that received a dietary supplement (group A) compared with those that did not receive the supplement group (B)?</p></li>
<li><p>Is there a difference in cholesterol associated with consuming oat bran compared with consuming corn flakes?</p></li>
<li><p>Does drug 2 produce more than 1 hour of additional sleep compared with drug 1?</p></li>
</ol>
<p>Your task, for each dataset, is to (a) determine and perform the appropriate nonparametric test and (b) interpret the result accurately.</p>
</div>
</div>

<div class="quarto-auto-generated-content">
<p><img src="img/poly-logo-2.jpg" class="slide-logo"></p>
<div class="footer footer-default">
<p>STAT218</p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>