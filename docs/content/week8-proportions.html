<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.550">

  <title>STAT218 - Introduction to categorical data analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-H3YKZX4J88"></script>

  <script type="text/javascript">

  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-H3YKZX4J88', { 'anonymize_ip': true});
  </script>
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Introduction to categorical data analysis</h1>
  <p class="subtitle">One- and two-sample inference for proportions</p>

<div class="quarto-title-authors">
</div>

</section>
<section id="todays-agenda" class="slide level2">
<h2>Today’s agenda</h2>
<ol type="1">
<li>Loose ends from last time</li>
<li>[lecture/discussion] Intro to CDA: inference for one and two proportions</li>
<li>[lab] 3 case studies</li>
</ol>
</section>
<section id="loose-end-1-practice-problem" class="slide level2">
<h2>Loose end 1: practice problem</h2>
<div class="columns">
<div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week8-proportions_files/figure-revealjs/unnamed-chunk-3-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<p>Data are standardized lengths of the anterior adductor muscle (AAM) of <em>Mytilus trossulus</em> mussels from five populations.</p>
<blockquote>
<p>Estimate mean AAM lengths for each population and test for differences between populations. If differences are determined to be significant, determine which populations differ significantly and provide interval estimates for the differences.</p>
</blockquote>
</div>
</div>
</section>
<section id="loose-end-1-practice-problem-1" class="slide level2">
<h2>Loose end 1: practice problem</h2>
<div class="columns">
<div class="column">
<p><strong>Summaries</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">boxplot</span>(aam.length <span class="sc">~</span> location, <span class="at">data =</span> mussels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week8-proportions_files/figure-revealjs/unnamed-chunk-5-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>mussels <span class="sc">|&gt;</span> <span class="fu">group_by</span>(location) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(aam.length), </span>
<span id="cb2-3"><a></a>            <span class="at">sd =</span> <span class="fu">sd</span>(aam.length), </span>
<span id="cb2-4"><a></a>            <span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  location     mean      sd     n
  &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;
1 Magadan    0.0780 0.0129      8
2 Newport    0.0748 0.00860     8
3 Petersburg 0.103  0.0162      7
4 Tillamook  0.0802 0.0120     10
5 Tvarminne  0.0957 0.0130      6</code></pre>
</div>
</div>
</div><div class="column">
<p><strong>ANOVA model</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(aam.length <span class="sc">~</span> location, <span class="at">data =</span> mussels)</span>
<span id="cb4-2"><a></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df   Sum Sq   Mean Sq F value   Pr(&gt;F)    
location     4 0.004520 0.0011299   7.121 0.000281 ***
Residuals   34 0.005395 0.0001587                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a><span class="fu">emmeans</span>(fit, <span class="sc">~</span> location, <span class="at">adjust =</span> <span class="st">'bonferroni'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> location   emmean      SE df lower.CL upper.CL
 Magadan    0.0780 0.00445 34   0.0659   0.0902
 Newport    0.0748 0.00445 34   0.0626   0.0870
 Petersburg 0.1034 0.00476 34   0.0905   0.1164
 Tillamook  0.0802 0.00398 34   0.0693   0.0911
 Tvarminne  0.0957 0.00514 34   0.0817   0.1097

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 5 estimates </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="loose-end-1-practice-problem-2" class="slide level2">
<h2>Loose end 1: practice problem</h2>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a><span class="fu">emmeans</span>(fit, <span class="sc">~</span> location) <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a></a>  <span class="fu">confint</span>(<span class="at">adjust =</span> <span class="st">'bonferroni'</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week8-proportions_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="fu">emmeans</span>(fit, <span class="sc">~</span> location) <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a></a>  <span class="fu">pairs</span>(<span class="at">adjust =</span> <span class="st">'bonferroni'</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week8-proportions_files/figure-revealjs/unnamed-chunk-12-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:65%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> contrast               estimate      SE df t.ratio p.value
 Magadan - Newport       0.00321 0.00630 34   0.510  1.0000
 Magadan - Petersburg   -0.02543 0.00652 34  -3.901  0.0043
 Magadan - Tillamook    -0.00219 0.00598 34  -0.366  1.0000
 Magadan - Tvarminne    -0.01769 0.00680 34  -2.600  0.1370
 Newport - Petersburg   -0.02864 0.00652 34  -4.394  0.0010
 Newport - Tillamook    -0.00540 0.00598 34  -0.904  1.0000
 Newport - Tvarminne    -0.02090 0.00680 34  -3.072  0.0417
 Petersburg - Tillamook  0.02324 0.00621 34   3.744  0.0067
 Petersburg - Tvarminne  0.00774 0.00701 34   1.105  1.0000
 Tillamook - Tvarminne  -0.01550 0.00650 34  -2.383  0.2291

P value adjustment: bonferroni method for 10 tests </code></pre>
</div>
</div>
</div><div class="column" style="width:35%;">

</div>
</div>
</section>
<section id="loose-end-2-power-calculations" class="slide level2">
<h2>Loose end 2: power calculations</h2>
<blockquote>
<p>How much data should I collect to detect differing means with a target power level?</p>
</blockquote>
<div class="columns">
<div class="column">
<p>To perform sample size power calculations, one needs:</p>
<ul>
<li>number of groups</li>
<li>target significance level (<span class="math inline">\(\alpha\)</span>)</li>
<li>target power level</li>
<li>guess or prior estimate of variance ratio <span class="math inline">\(\frac{\text{group variation}}{\text{error variation}}\)</span></li>
</ul>
</div><div class="column">
<p>To detect means that differ among 5 groups with half of the error variability with 90% power:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="fu">power.anova.test</span>(<span class="at">groups =</span> <span class="dv">5</span>, </span>
<span id="cb11-2"><a></a>                 <span class="at">sig.level =</span> <span class="fl">0.05</span>, </span>
<span id="cb11-3"><a></a>                 <span class="at">power =</span> <span class="fl">0.9</span>, </span>
<span id="cb11-4"><a></a>                 <span class="at">within.var =</span> <span class="dv">1</span>, </span>
<span id="cb11-5"><a></a>                 <span class="at">between.var =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

         groups = 5
              n = 8.711259
    between.var = 0.5
     within.var = 1
      sig.level = 0.05
          power = 0.9

NOTE: n is number in each group</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="review-categorical-data" class="slide level2">
<h2>Review: categorical data</h2>
<blockquote>
<p>A variable is categorical if its values are one of several categories.</p>
</blockquote>
<div class="columns">
<div class="column" style="width:65%;">
<p>What we have seen so far:</p>
<ul>
<li><strong>frequency distributions</strong> for one categorical variable</li>
<li><strong>contingency tables</strong> for two categorical variables</li>
<li>use of categorical variables for grouping in inference for two or more means</li>
</ul>
<p>Inference for categorical data has a different flavor:</p>
<ul>
<li>non-numeric values <span class="math inline">\(\Rightarrow\)</span> can’t compute usual statistics</li>
<li>focus on <em>proportions</em> instead</li>
</ul>
</div><div class="column" style="width:35%;">
<div class="cell">
<div class="cell-output-display">
<table style="width:25%;">
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">CC</th>
<th style="text-align: center;">CT</th>
<th style="text-align: center;">TT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">173</td>
<td style="text-align: center;">261</td>
<td style="text-align: center;">161</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week8-proportions_files/figure-revealjs/unnamed-chunk-15-1.png" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table style="width:38%;">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">CC</th>
<th style="text-align: center;">CT</th>
<th style="text-align: center;">TT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.2908</td>
<td style="text-align: center;">0.4387</td>
<td style="text-align: center;">0.2706</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="two-settings-for-cda" class="slide level2">
<h2>Two settings for CDA</h2>
<blockquote>
<p>Inferential techniques for categorical data analysis depend on how many variables and how many categories per variable.</p>
</blockquote>
<div class="columns">
<div class="column" style="width:60%;">
<p>We will distinguish two broad settings:</p>
<ol type="1">
<li>[binomial data] Two categories</li>
<li>[multinomial data] More than two categories</li>
</ol>
<p>These get their names – binomial and multinomial – from the probability models that describe the frequency distributions.</p>
<p><em>We will focus on inferences for population proportions from binomial data.</em></p>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week8-proportions_files/figure-revealjs/unnamed-chunk-16-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="on-binomial-proportions" class="slide level2">
<h2>On binomial proportions</h2>
<blockquote>
<p>Inference for categorical data focuses on population proportions</p>
</blockquote>
<div class="columns">
<div class="column" style="width:70%;">
<p>Consider the binomial data setting:</p>
<ul>
<li>a single categorical variable with two categories</li>
<li>one category represents an outcome, trait, or property of interest</li>
</ul>
<p>The <strong>population proportion</strong> is the frequency of occurrence of the category of interest.</p>
<p><span class="math display">\[p = \frac{\# \text{ total occurrences}}{\text{population size } N}\]</span></p>
<p>If an individual is selected at random, <span class="math inline">\(p\)</span> also gives the probability of an occurrence.</p>
</div><div class="column" style="width:30%;">
<p>Example binomial data:</p>
<div class="cell">
<div class="cell-output-display">
<table style="width:26%;">
<colgroup>
<col style="width: 11%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">ID</th>
<th style="text-align: center;">Diabetes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">62804</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: center;">62588</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: center;">70730</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: center;">68548</td>
<td style="text-align: center;">Yes</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="estimating-proportions" class="slide level2">
<h2>Estimating proportions</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p>Consider using the diabetes data to estimate prevalence.</p>
<ul>
<li>data are a random sample</li>
<li>so sample statistics should approximate population statistics</li>
<li>sample proportions provide estimates of population proportions</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table style="width:60%;">
<caption><em>Diabetes data summary</em></caption>
<colgroup>
<col style="width: 23%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">No</th>
<th style="text-align: center;">Yes</th>
<th style="text-align: center;">row.sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>count</strong></td>
<td style="text-align: center;">443</td>
<td style="text-align: center;">57</td>
<td style="text-align: center;">500</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>proportion</strong></td>
<td style="text-align: center;">0.886</td>
<td style="text-align: center;">0.114</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column" style="width:55%;">
<p>We’ll formalize this as estimating the <strong>population proportion</strong> <span class="math display">\[p = \frac{\# \text{ individuals with diabetes}}{\text{total population size } N}\]</span> Using the <strong>sample proportion</strong> <span class="math display">\[\hat{p} = \frac{\# \text{ respondents with diabetes}}{\text{sample size } n}\]</span> So <span class="math inline">\(\hat{p} = 0.114\)</span> estimates the prevalence of diabetes (population proportion <span class="math inline">\(p\)</span>).</p>
</div>
</div>
</section>
<section id="two-interpretations" class="slide level2">
<h2>Two interpretations</h2>
<p>The point estimate</p>
<p><span class="math display">\[\hat{p} = \frac{\# \text{ respondents with diabetes}}{\text{sample size } n} = \frac{57}{500} = 0.114\]</span></p>
<p>has two (equivalent) interpretations:</p>
<ol type="1">
<li>the prevalence of diagnosed diabetes among U.S. adults is estimated to be 11.4%</li>
<li>the probability that a randomly chosen U.S. adult has diagnosed diabetes is 0.114</li>
</ol>
</section>
<section id="variability-of-binomial-data" class="slide level2">
<h2>Variability of binomial data</h2>
<blockquote>
<p>Binomial data are most variable when <span class="math inline">\(p = 0.5\)</span> and least variable when <span class="math inline">\(p \approx 0\)</span> or <span class="math inline">\(1\)</span></p>
</blockquote>
<div class="columns">
<div class="column" style="width:65%;">
<p>If <span class="math inline">\(p\)</span> represents the proportion of the population in a category of interest (<em>e.g.</em>, has diabetes):</p>
<ul>
<li><p><span class="math inline">\(p\)</span> near 1 or 0: minimum “spread”</p>
<ul>
<li>most individuals are in one category</li>
</ul></li>
<li><p><span class="math inline">\(p\)</span> near 0.5: maximum “spread”</p></li>
</ul>
<p>A measure of spread is therefore:</p>
<p><span class="math display">\[p(1 - p)\]</span></p>
</div><div class="column" style="width:35%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week8-proportions_files/figure-revealjs/unnamed-chunk-19-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sampling-distribution-of-hatp" class="slide level2">
<h2>Sampling distribution of <span class="math inline">\(\hat{p}\)</span></h2>
<div class="columns">
<div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week8-proportions_files/figure-revealjs/unnamed-chunk-20-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<p>The sample proportion <span class="math inline">\(\hat{p}\)</span> has a sampling distribution that can be approximated by a normal model.</p>
<ul>
<li>centered at true proportion <span class="math inline">\(p\)</span></li>
<li>standard deviation is <span class="math display">\[SD(\hat{p}) = \sqrt{\frac{p(1 - p)}{n}} \quad\left(\frac{\text{variability}}{\text{sample size}}\right)\]</span></li>
</ul>
</div>
</div>
</section>
<section id="estimation-uncertainty" class="slide level2">
<h2>Estimation uncertainty</h2>
<blockquote>
<p>Recall: a standard error estimates the variability of a sample statistic across samples</p>
</blockquote>
<p>The standard error for the sample proportion is: <span class="math display">\[SE\left(\hat{p}\right) = \sqrt{\frac{\hat{p}(1 - \hat{p})}{n}}\]</span></p>
<p>For the diabetes data this estimate is <span class="math inline">\(SE(\hat{p})\)</span> = 0.014213.</p>
<ul>
<li><p>on average, the sample proportion varies by 0.014 from sample to sample</p></li>
<li><p>using a normal model:</p>
<ul>
<li>68% of samples produce a <span class="math inline">\(\hat{p}\)</span> within 0.014 of <span class="math inline">\(p\)</span></li>
<li>95% of samples produce a <span class="math inline">\(\hat{p}\)</span> within 0.028 of <span class="math inline">\(p\)</span></li>
</ul></li>
</ul>
</section>
<section id="inference-for-a-proportion" class="slide level2">
<h2>Inference for a proportion</h2>
<div class="columns">
<div class="column" style="width:45%;">
<div class="cell">
<div class="cell-output-display">
<table style="width:35%;">
<caption>Point estimate for diabetes prevalence</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">p.hat</th>
<th style="text-align: center;">p.hat.se</th>
<th style="text-align: center;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.114</td>
<td style="text-align: center;">0.01421</td>
<td style="text-align: center;">500</td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column" style="width:55%;">
<blockquote>
<p><em>Interpretation:</em> It is estimated that the proportion of the U.S. adult population with diagnosed diabetes is 11.4% (<em>SE = 1.42%</em>, <em>n = 500</em>).</p>
</blockquote>
</div>
</div>
<p>Given a point estimate and standard error, we can carry out inference using the normal model.</p>
<ul>
<li>intervals: <span class="math inline">\(\hat{p} \pm c \times SE(\hat{p})\)</span></li>
<li>tests: <span class="math inline">\(Z = \frac{\hat{p} - p_0}{SD_0(\hat{p})}\)</span></li>
<li>critical value <span class="math inline">\(c\)</span> uses normal model</li>
</ul>
</section>
<section id="confidence-intervals" class="slide level2">
<h2>Confidence intervals</h2>
<div class="columns">
<div class="column">
<p>To calculate a 95% confidence interval “by hand” for the diabetes prevalence:</p>
<p><span class="math display">\[
0.114 \pm 2\times 0.01421 = (0.0881, 0.1459)
\]</span></p>
</div><div class="column">
<blockquote>
<p>With 95% confidence, it is estimated that between 8.81% and 14.59% of the U.S. adult population has diagosed diabetes.</p>
</blockquote>
</div>
</div>
<p>The critical value <span class="math inline">\(c\)</span> comes from the normal model.</p>
<ul>
<li><p>exact value depends on desired coverage</p></li>
<li><p>empirical rule:</p>
<ul>
<li><span class="math inline">\(c = 1\)</span> gives a 68% interval</li>
<li><span class="math inline">\(c = 2\)</span> gives a 95% interval</li>
<li><span class="math inline">\(c = 3\)</span> gives a 99.7% interval</li>
</ul></li>
<li><p>calculation in R: <code>qnorm((1 - coverage)/2, lower.tail = F)</code></p></li>
</ul>
</section>
<section id="hypothesis-tests" class="slide level2">
<h2>Hypothesis tests</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Consider testing: <span class="math display">\[\begin{cases}H_0: p = p_0 \\ H_A: p \mathrel{\substack{&lt; \\\neq \\ &gt;}} p_0\end{cases}\]</span></p>
<p>Hypothesis tests use the test statistic:</p>
<p><span class="math display">\[Z = \frac{\hat{p} - p_0}{SD_0(\hat{p})} = \frac{\hat{p} - p_0}{\sqrt{\frac{p_0 (1 - p_0)}{n}}}\]</span></p>
<p>And reject when <span class="math inline">\(Z\)</span> is large in the direction of the alternative.</p>
<p>Under <span class="math inline">\(H_0\)</span>, the sampling distribution of <span class="math inline">\(Z\)</span> is approximated by a normal model.</p>
</div><div class="column" style="width:50%;">
<p>For instance, to test whether diabetes prevalence exceeds 10%: <span class="math display">\[Z = \frac{0.114 - 0.1}{\sqrt{\frac{0.1\times 0.9}{500}}} = 1.043\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week8-proportions_files/figure-revealjs/unnamed-chunk-22-1.png" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="inference-in-r" class="slide level2">
<h2>Inference in R</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p>There are two steps to performing the appropriate inference in R:</p>
<ol type="1">
<li>Format the variable of interest as a factor with the category of interest as the first level</li>
<li>Construct a table of the frequency distribution</li>
<li>Pass the table to <code>prop.test()</code></li>
</ol>
<p>Remarks about output:</p>
<ul>
<li><code>X-squared</code> gives <span class="math inline">\(Z^2\)</span></li>
<li><code>correct = F</code> performs the test without continuity correction</li>
</ul>
</div><div class="column" style="width:55%;">
<p>The test from the previous slide:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="co"># 1. construct factor</span></span>
<span id="cb13-2"><a></a>diabetes <span class="ot">&lt;-</span> <span class="fu">factor</span>(nhanes<span class="sc">$</span>Diabetes, </span>
<span id="cb13-3"><a></a>                   <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'Yes'</span>, <span class="st">'No'</span>))</span>
<span id="cb13-4"><a></a></span>
<span id="cb13-5"><a></a><span class="co"># 2. store table</span></span>
<span id="cb13-6"><a></a>diabetes.tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(diabetes)</span>
<span id="cb13-7"><a></a></span>
<span id="cb13-8"><a></a><span class="co"># 3. pass to prop.test</span></span>
<span id="cb13-9"><a></a><span class="fu">prop.test</span>(diabetes.tbl, <span class="at">p =</span> <span class="fl">0.1</span>, </span>
<span id="cb13-10"><a></a>          <span class="at">alternative =</span> <span class="st">'greater'</span>, <span class="at">correct =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test without continuity correction

data:  diabetes.tbl, null probability 0.1
X-squared = 1.0889, df = 1, p-value = 0.1484
alternative hypothesis: true p is greater than 0.1
95 percent confidence interval:
 0.09266984 1.00000000
sample estimates:
    p 
0.114 </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="exact-inference" class="slide level2">
<h2>Exact inference</h2>
<blockquote>
<p>The normal model is an approximation.</p>
</blockquote>
<p>The test can also be performed using the <em>exact</em> sampling distribution obtained from a binomial probability model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a><span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">57</span>, <span class="at">n =</span> <span class="dv">500</span>, <span class="at">p =</span> <span class="fl">0.1</span>, <span class="at">alternative =</span> <span class="st">'greater'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  57 and 500
number of successes = 57, number of trials = 500, p-value = 0.1659
alternative hypothesis: true probability of success is greater than 0.1
95 percent confidence interval:
 0.0913675 1.0000000
sample estimates:
probability of success 
                 0.114 </code></pre>
</div>
</div>
<p>Inputs:</p>
<ul>
<li><code>x</code> gives the number of occurrences of the category of interest</li>
<li><code>n</code> gives the sample size</li>
</ul>
</section>
<section id="continuity-correction" class="slide level2">
<h2>Continuity correction</h2>
<blockquote>
<p>The approximation error for the normal model may be adjusted using a “continuity correction”</p>
</blockquote>
<p>Idea: adjust the test statistic slightly for a more conservative test.</p>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a><span class="fu">prop.test</span>(diabetes.tbl, <span class="at">p =</span> <span class="fl">0.1</span>, </span>
<span id="cb17-2"><a></a>          <span class="at">alternative =</span> <span class="st">'greater'</span>, <span class="at">correct =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test without continuity correction

data:  diabetes.tbl, null probability 0.1
X-squared = 1.0889, df = 1, p-value = 0.1484
alternative hypothesis: true p is greater than 0.1
95 percent confidence interval:
 0.09266984 1.00000000
sample estimates:
    p 
0.114 </code></pre>
</div>
</div>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="fu">prop.test</span>(diabetes.tbl, <span class="at">p =</span> <span class="fl">0.1</span>, </span>
<span id="cb19-2"><a></a>          <span class="at">alternative =</span> <span class="st">'greater'</span>, <span class="at">correct =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test with continuity correction

data:  diabetes.tbl, null probability 0.1
X-squared = 0.93889, df = 1, p-value = 0.1663
alternative hypothesis: true p is greater than 0.1
95 percent confidence interval:
 0.09176378 1.00000000
sample estimates:
    p 
0.114 </code></pre>
</div>
</div>
</div>
</div>
<p>Notice that the correction (right) results in a test that much more closely matches the exact test.</p>
</section>
<section id="your-turn-sleep-trouble" class="slide level2">
<h2>Your turn: sleep trouble</h2>
<blockquote>
<p>Use the NHANES data to estimate the proportion of U.S. adults reporting sleep trouble. Test whether at least 20% of U.S. adults report sleep trouble.</p>
</blockquote>
<div class="columns">
<div class="column">
<ol type="1">
<li><p>Compute point estimate and standard error</p></li>
<li><p>Perform the hypothesis test</p>
<ul>
<li>write the hypotheses</li>
<li>calculate the value of the test statistic</li>
<li>record the <span class="math inline">\(p\)</span>-value</li>
</ul></li>
<li><p>Construct an interval estimate</p></li>
</ol>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a><span class="co"># to get you started</span></span>
<span id="cb21-2"><a></a>trouble <span class="ot">&lt;-</span> <span class="fu">factor</span>(nhanes<span class="sc">$</span>SleepTrouble, </span>
<span id="cb21-3"><a></a>                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'Yes'</span>, <span class="st">'No'</span>))</span>
<span id="cb21-4"><a></a>trouble.tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(trouble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table style="width:17%;">
<caption>Having sleep trouble?</caption>
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Yes</th>
<th style="text-align: center;">No</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">139</td>
<td style="text-align: center;">361</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="comparing-two-proportions" class="slide level2">
<h2>Comparing two proportions</h2>
<blockquote>
<p>Inference on the <em>difference between proportions</em> uses substantially similar methods</p>
</blockquote>
<div class="columns">
<div class="column">
<div class="cell">
<div class="cell-output-display">
<table style="width:50%;">
<caption>Vitamin C experiment</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Cold</th>
<th style="text-align: center;">NoCold</th>
<th style="text-align: center;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Placebo</strong></td>
<td style="text-align: center;">335</td>
<td style="text-align: center;">76</td>
<td style="text-align: center;">411</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>VitC</strong></td>
<td style="text-align: center;">302</td>
<td style="text-align: center;">105</td>
<td style="text-align: center;">407</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>vitamin C and placebo treatments were randomly allocated to 818 volunteers</li>
<li>volunteers took treatments daily for a cold season</li>
<li>study recorded how many volunteers came down with a cold</li>
</ul>
</div><div class="column">
<p>Consider inference on the difference</p>
<p><span class="math display">\[p_\text{placebo} - p_\text{vitamin C}\]</span></p>
<!-- $$\begin{cases}H_0: p_\text{placebo} - p_\text{vitamin C} \leq 0 \\ H_A: p_\text{placebo} - p_\text{vitamin C} > 0 \end{cases}$$ -->
<p>Inferences based on groupwise estimates:</p>
<ul>
<li><p>point estimate: <span class="math inline">\(\hat{p}_\text{placebo} - \hat{p}_\text{vitamin C}\)</span></p></li>
<li><p>standard error: <span class="math inline">\(\sqrt{SE^2(\hat{p}_\text{placebo}) + SE^2(\hat{p}_\text{vitamin C})}\)</span></p></li>
<li><p>interval: <span class="math inline">\(\hat{p}_\text{placebo} - \hat{p}_\text{vitamin C} \pm c\times SE\)</span></p></li>
</ul>
</div>
</div>
</section>
<section id="tests-for-a-difference-in-proportions" class="slide level2">
<h2>Tests for a difference in proportions</h2>
<div class="columns">
<div class="column">
<p>Consider testing:</p>
<p><span class="math display">\[\begin{cases} H_0: p_1 = p_2 \\ H_A: p_1 \mathrel{\substack{&lt; \\ \neq \\ &gt;}} p_2 \end{cases}\]</span></p>
<p>Hypothesis tests use the test statistic:</p>
<p><span class="math display">\[Z = \frac{\hat{p}_1 - \hat{p}_2}{\sqrt{\hat{p}(1 - \hat{p})\left(\frac{1}{n_1} + \frac{1}{n_2}\right)}}\]</span></p>
<p>Where: <span class="math display">\[\hat{p} = \frac{n_1\hat{p}_1 + n_2\hat{p}_2}{n_1 + n_2}\]</span></p>
</div><div class="column">
<p>Under <span class="math inline">\(H_0\)</span>, the sampling distribution of <span class="math inline">\(Z\)</span> is approximated by a normal model.</p>
<ul>
<li>reject when <span class="math inline">\(Z\)</span> is sufficiently large in the direction of the alternative</li>
</ul>
<p>Upper-sided test for vitamin C data:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week8-proportions_files/figure-revealjs/unnamed-chunk-30-1.png" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="vitamin-c-example-in-detail" class="slide level2">
<h2>Vitamin C example in detail</h2>
<div class="columns">
<div class="column">
<p>Sample proportions:</p>
<div class="cell">
<div class="cell-output-display">
<table style="width:44%;">
<colgroup>
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Cold</th>
<th style="text-align: center;">NoCold</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Placebo</strong></td>
<td style="text-align: center;">0.8151</td>
<td style="text-align: center;">0.1849</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>VitC</strong></td>
<td style="text-align: center;">0.742</td>
<td style="text-align: center;">0.258</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Hypotheses <span class="math display">\[\begin{cases} H_0: p_\text{placebo} \leq p_\text{vitaminC} \\ H_A: p_\text{placebo} &gt; p_\text{vitaminC} \end{cases}\]</span> This corresponds to testing whether vitamin C reduces the probability of getting a cold.</p>
</div><div class="column">
<p><span class="math display">\[\begin{align*} &amp;\hat{p}_\text{placebo} - \hat{p}_\text{vitaminC} = \hspace{15cm} \\\\
&amp;\hat{p} = \hspace{15cm} \\\\
&amp;Z =
\end{align*}\]</span></p>
<p><span class="math inline">\(p\)</span> value from normal model:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="week8-proportions_files/figure-revealjs/unnamed-chunk-32-1.png" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="an-interval-for-the-difference" class="slide level2">
<h2>An interval for the difference</h2>
<p>To compute a confidence interval for the difference in proportions:</p>
<p><span class="math display">\[\hat{p}_\text{placebo} - \hat{p}_\text{vitaminC} \pm 2\times \sqrt{SE^2(\hat{p}_\text{placebo}) + SE^2(\hat{p}_\text{vitaminC})}\]</span></p>
<p>Carrying out the calculation by hand:</p>
<p><span class="math display">\[\begin{align*}
SE^2(\hat{p}_\text{placebo}) &amp;= \hspace{8cm}\\\\
SE^2(\hat{p}_\text{vitaminC}) &amp;= \hspace{8cm}\\\\
\hspace{3cm} \pm 2\times \hspace{5cm} &amp;= \Big( \hspace{2cm}, \hspace{2cm}\Big)
\end{align*}\]</span></p>
</section>
<section id="inference-in-r-1" class="slide level2">
<h2>Inference in R</h2>
<div class="columns">
<div class="column">
<p>Three steps:</p>
<ol type="1">
<li><p>Construct a table of the frequency distribution by group</p>
<ul>
<li>outcome/trait of interest should be first column</li>
<li>groups should be rows</li>
</ul></li>
<li><p>Pass to <code>prop.test()</code></p></li>
</ol>
<p>Identify at left:</p>
<ul>
<li>point estimates</li>
<li>test statistic</li>
<li><span class="math inline">\(p\)</span>-value</li>
<li>confidence interval</li>
</ul>
</div><div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a><span class="co"># 1. construct table</span></span>
<span id="cb22-2"><a></a>cold</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Cold NoCold
Placebo  335     76
VitC     302    105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a><span class="co"># 2. pass to prop.test</span></span>
<span id="cb24-2"><a></a><span class="fu">prop.test</span>(cold, <span class="at">alternative =</span> <span class="st">'two.sided'</span>, </span>
<span id="cb24-3"><a></a>          <span class="at">correct =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions without continuity correction

data:  cold
X-squared = 6.3366, df = 1, p-value = 0.01183
alternative hypothesis: two.sided
95 percent confidence interval:
 0.01636477 0.12977607
sample estimates:
   prop 1    prop 2 
0.8150852 0.7420147 </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="your-turn-two-cases" class="slide level2">
<h2>Your turn: two cases</h2>
<div class="columns">
<div class="column">
<p>Researchers categorized 3,112 individuals in American Samoa according to whether they were obese and recorded whether subjects had cardiovascular disease (CVD).</p>
<div class="cell">
<div class="cell-output-display">
<table style="width:50%;">
<colgroup>
<col style="width: 20%">
<col style="width: 12%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Deaths</th>
<th style="text-align: center;">NonDeaths</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Obese</strong></td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2045</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>NotObese</strong></td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">1044</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>Test for a difference in disease rates between obese and non-obese populations, and produce an interval estimate for the difference in proportions.</em></p>
</div><div class="column">
<p>Researchers identified 86 lung cancer patients and 86 controls (without lung cancer), and categorized them according to whether they were smokers or non-smokers.</p>
<div class="cell">
<div class="cell-output-display">
<table style="width:51%;">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Smokers</th>
<th style="text-align: center;">NonSmokers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Cancer</strong></td>
<td style="text-align: center;">83</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Control</strong></td>
<td style="text-align: center;">72</td>
<td style="text-align: center;">14</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>Test for a difference in the proportion of smokers among cancer patients compared with controls, and produce an interval estimate for the difference.</em></p>
</div>
</div>

<div class="quarto-auto-generated-content">
<p><img src="img/poly-logo-2.jpg" class="slide-logo"></p>
<div class="footer footer-default">
<p>STAT218</p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>