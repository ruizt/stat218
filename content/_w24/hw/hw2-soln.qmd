---
title: "Homework 2: Descriptive statistics"
author: "STAT218"
author-title: "Course"
date: today
published-title: "SOLUTION"
execute: 
  eval: true
  echo: false
format: 
  html:
    toc: true
  docx:
    toc: false
prefer-html: true
embed-resources: true
---

*Instructions: type up your answers and submit your work electronically via Gradescope. Questions with a learning outcome indicated in brackets will be evaluated for credit; other questions are provided for additional practice. You are expected to answer all questions. Note that an R project with datasets and prompts is provided on the class posit.cloud workspace. Please do not submit R codes; show only output or graphics relevant to answering the question.*

1.  \[L3\] The `oibiostat::frog` dataset contains measurements on samples of frog egg clutches collected at various study sites in early 2013 to investigate the effect of altitude on relative investment in egg size versus clutch size (number of eggs). Visualize the frequency distributions of clutch volume, egg size, and clutch size. For each variable, describe the shape and modality of the distribution and calculate appropriate measures of spread and center.

```{r q1, fig.width=10, fig.height=3}
library(oibiostat)
data(frog)

par(mfrow = c(1, 3))
# clutch volume
hist(frog$clutch.volume,
     xlab = 'clutch volume',
     ylab = 'frequency', 
     main = 'Clutch volume')

# clutch size
hist(frog$clutch.size,
     breaks = 20,
     xlab = 'clutch size',
     ylab = 'frequency', 
     main = 'Clutch size')

# egg size
hist(frog$egg.size,
     breaks = 20,
     xlab = 'egg size',
     ylab = 'frequency', 
     main = 'Egg size')
```

**Clutch volume** is right-skewed and unimodal with a few potential outliers over 2000. Students should choose median to measure center in light of skew and IQR in light of outliers. 
```{r}
c(median = median(frog$clutch.volume),
  iqr = IQR(frog$clutch.volume)) |>
  pander::pander()
```

**Clutch size** is unimodal and symmetric, though students might perceive a slight right skew, which is an acceptable answer. Any measures of center and spread are acceptable.
```{r}
c(mean = mean(frog$clutch.size), 
  median = median(frog$clutch.size),
  iqr = IQR(frog$clutch.size),
  sd = sd(frog$clutch.size)) |>
  pander::pander()
```

**Egg size** is bimodal and neither symmetric nor skewed. The only acceptable measure of center is mode (for each mode), which can be visually located at 1.9 and 2.3 (or thereabouts, depending on the binning resolution used). As there are no obvious outliers, any measure of spread is acceptable.
```{r}
c(iqr = IQR(frog$egg.size),
  sd = sd(frog$egg.size)) |>
  pander::pander()
```

2.  Vu and Harrington exercise 1.8. Below are some observations from a study collecting data to analyze smoking habits of UK residents.

    a.  What does each row of this table represent?
    b.  How many participants were included in the study?
    c.  For each variable, indicate whether it is numerical or categorical. If numerical, indicate whether it is continuous or discrete; if categorical, indicate if it is nominal or ordinal.

![](img/hw2-vh1-8.png)

3.  \[L2\] Vu and Harrington exercise 1.17. The following scatterplot shows life expectancies and percentages of internet users for 208 countries.

    a.  Describe the relationship between life expectancy and percentage of internet users. Specifically: is there an apparent association, and if so, is it positive or negative and linear or nonlinear?
    b.  State a possible confounding variable that might explain this relationship and describe how the confounder might relate to both the percentage of internet users and the life expectancy of a country.
    c.  Are these data experimental or observational? And if you had to guess, were they obtained by a random or nonrandom sample, and why?

![](img/hw2-vh1-17.png)

**Answers**:

a. There is a positive and nonlinear association between percentage of internet users and life expectancy.

b. Any development indicators are acceptable answers: more developed countries have better infrastructure, including internet access, and also higher life expectancies.

c. Observational. Data are likely from a nonrandom sample, because the sample most likely comprises all countries for which these data are available.

4.  Vu and Harrington exercise 1.28. For each of the distributions (a), (b), and (c), describe the shape and modality and identify the matching boxplot from (1), (2), and (3).

![](img/hw2-vh1-28.png)

5.  Vu and Harrington exercise 1.36.

![](img/hw2-vh1-36.png)

6.  \[L3\] The `oibiostat::yrbss` dataset contains measurements on a small collection of variables from 13,583 survey responses collected as part of the CDC's Youth Risk Behavior Surveillance System (YRBSS) from 1991-2013. The objective of the survey program is to track behaviors with potential negative physical and mental health impacts among adolescents.

    a.  Summarize the racial composition of survey respondents by academic grade. Produce both a contingency table and a proportional bar plot. Make sure to choose the correct (row or column) normalization for your bar plot so that it shows the racial composition by grade (not the grade composition by race). Are there apparent differences in racial composition across grades?
    b.  Make a bar plot showing the frequency distribution of hours of sleep on school nights. Based on the summary, what is the typical amount of sleep respondents get on school nights?
    c.  Produce a tabular or graphical summary that addresses the question: do older students sleep more on school nights than younger students?
    d.  Visualize the frequency distribution of the number of days per week that survey participants are physically active. Describe the distribution and indicate whether the variable is discrete or continuous. Is the mean an appropriate measure of center for this data? Why or why not?
    e.  Produce side-by-side boxplots visualizing the number of days per week that survey participants are physically active *by grade*. Based on the graphical summary, do there appear to be differences in physical activity by grade? Explain.


**Answers**:

a. The contingency table and plot are shown below. Students need only produce these plots; no commentary is necessary. However, if table is cut off or organized poorly, which will happen if race is put in columns due to label length, students should be asked to revise and change the orientation of the table for readability. 

```{r q6, fig.width = 8, fig.height = 4}
data(yrbss)

tbl <- table(yrbss$race, yrbss$grade)[, c(4, 1, 2, 3, 5)]
tbl |> pander::pander()

par(mar = c(3, 3, 1, 18))
t(t(tbl)/colSums(tbl)) |> 
  barplot(legend.text = T,
          args.legend = list(
            x = 12, y = 1))
```

b. Most students seem to get 7 hours per night. This is the most frequent category.

```{r}
table(yrbss$school.night.hours.sleep)[c(1, 3, 4, 5, 6, 7, 2)] |>
      barplot()
```

c. Students may do this either using age (treated as categorical), or using grade as a proxy for age. Both possible plots are shown below. Older students do indeed seem to get less sleep, reflected by the decreasing proportions of students in each grade/age getting over 6 hours per night.

```{r, fig.width = 8, fig.height=6}
tbl <- table(yrbss$age, yrbss$school.night.hours.sleep)[, c(1, 3, 4, 5, 6, 7, 2)] 

par(mar = c(3, 3, 1, 8))
t(tbl/rowSums(tbl)) |> 
  barplot(legend.text = T, 
          args.legend = list(x = 10, y = 1))

tbl <- table(yrbss$grade, yrbss$school.night.hours.sleep)[c(4, 1, 2, 3, 5), c(1, 3, 4, 5, 6, 7, 2)] 

par(mar = c(3, 3, 1, 10))
t(tbl/rowSums(tbl)) |> 
  barplot(legend.text = T, 
          args.legend = list(x = 7, y = 1))
```

d. Number of days per week of physical activity is a discrete variable. Students should choose an appropriate number of breaks so that there are no gaps in the histogram. The distribution is bimodal and symmetric; because of the shape, mean is a poor choice for measuring the center of the distribution, as it will locate the least frequent values.

```{r, fig.width=4, fig.height = 3}
hist(yrbss$physically.active.7d,
     breaks = 5,
     xlab = 'number of days per week of physical activity',
     ylab = 'frequency',
     main = '')
```

e. The plot is shown below. Ignoring the 'other' category, which comprises only a handful of respondents, days of physical activity do not seem to differ by grade substantially, except possibly in grade 12 -- medians are the same across grades and interquartile ranges are similar for all grades except 12.

```{r, fig.width = 3, fig.height = 4}
boxplot(physically.active.7d ~ grade, 
        data = yrbss, 
        ylab = 'physically active days')
```

7.  \[L3\] Vu and Harrington exercise 1.39. Trait anger is defined as a relatively stable personality trait that is manifested in the frequency, intensity, and duration of feelings associated with anger. People with high trait anger have rage and fury more often, more intensely, and with long-laster episodes than people with low trait anger. It is thought that people with high trait anger might be particularly susceptible to coronary heart disease; 12,986 participants were recruited for a study examining this hypothesis. Participants were followed for five years. The following table shows data for the participants identified as having normal blood pressure (normotensives).

    a.  What percentage of participants have moderate anger scores?
    b.  What percentage of participants who experienced a CHD event have moderate anger scores?
    c.  What percentage of participants with high trait anger scores experienced a CHD event?
    d.  What percentage of participants with low trait anger scores experienced a CHD event?
    e.  What is the ratio of the percentages in (c) and (d)? (This is called a "relative risk" of CHD events.) Based on this, does it appear that the risk of a CHD event is higher in the high trait anger group?
    f.  Produce a proportional bar plot that substantiates your answer in (e).

![](img/hw2-vh1-39.png){width="300"}

```{r}
anger <- matrix(data = c(53, 110, 27, 3057, 4704, 606), 
                nrow = 2, 
                byrow = T, 
                dimnames = list(chd = c('yes', 'no'),
                                anger = c('low', 'moderate', 'high'))
                )
```

Students should give answers in complete sentences.

a. `r (colSums(anger)[2]/sum(anger))*100`% of participants have moderate anger scores.

b. `r (anger/rowSums(anger))[1,2]*100`% of participants who experienced a CHD event have moderate anger scores.

c. `r t(t(anger)/colSums(anger))[1, 3]*100`% of participants with high anger scores experienced a CHD event.

d. `r t(t(anger)/colSums(anger))[1, 1]*100`% of participants with low anger scores experienced a CHD event.

e. The percentage of participants who experienced a CHD event was `r (t(t(anger)/colSums(anger))[1, 3])/(t(t(anger)/colSums(anger))[1, 1])` times higher in the high anger group compared with the low anger group.

f. A proportional bar plot of the percentage of participants who experienced a CHD event by trait anger group does the trick.

```{r}
t(t(anger)/colSums(anger)) |> 
  barplot(legend.text = c('no CHD', 'CHD'))
```
