---
title: "Test 2"
subtitle: "One- and two-sample inference for means [L3, L4, L5]"
author: "STAT218"
author-title: "Course"
date: "5/10/24"
published-title: "Due date"
execute: 
  include: false
format: 
  html:
    toc: true
  docx:
    toc: false
prefer-html: true
embed-resources: true
---

```{r packages}
library(tidyverse)
```

## Instructions

You have 48 hours from the release of this assignment to complete and submit your work. You may refer to all class materials, notes, and textbooks, but must complete this assignment on your own. By submitting your work, you are affirming that your work is your own and you have not consulted with anyone else in preparing your answers or generated your answers or analyses using AI. Failure to adhere to this expectation will be considered an act of academic dishonesty and result in loss of credit.

You will find a project with a mostly empty script in the class Posit cloud workspace; use this to complete your analyses where required. Note that not all parts require you to perform any calculations; some questions are purely qualitative. Use the prompts as your guide, not the script.

Once you have completed your analyses for the portions requiring use of statistical software, submit your work by filling out the test 2 form posted on the course website. The form will automatically save your work, so you can return to it over the course of the 48-hour test window.

The form will stop accepting responses at the deadline, so **make sure you submit by 5pm on Friday 5/10**. Lastly, keep in mind that you will be given the opportunity to revise problems that you miss the first time around to earn back credit.

## Problems

### Problem 1: gifted children

1. [L3, L4, L5] The `gifted` dataset contains data on 36 children identified as gifted in a large city. Assume for the purpose of the problem that the data are from a random sample of gifted children in the metropolitan region where the data were collected. 

    a. [L3] Is there a relationship between the mother's IQ and the child's test score? Construct a scatterplot and compute and interpret the correlation.
    b. [L3] Repeat but with the father's IQ.
    c. [L5] Given your results in (a)-(b), formulate a hypothesis about which parent's IQ is higher. Explain your reasoning.
    d. [L5] Construct a histogram of the pairwise differences between the mother's IQ and father's IQ for each child in the dataset and check the assumptions for inference using the $t$ model.
    e. [L4, L5] Test the hypothesis you proposed in (c) at the 1% level and provide a corresponding interval estimate. Report your results in the narrative style introduced in class.
    f. [L4, L5] It's thought that the mean age by which infants can count to 10 is around two years old. Test the hypothesis at the 5% level that gifted children do this sooner and provide a corresponding interval estimate. Interpret the test results and interval estimate in context following the narrative style introduced in class.

```{r gifted data}
openintro::gifted |> write_csv(file = 'data/gifted.csv')
```

```{r problem 1}
# read in data
gifted <- read_csv('data/gifted.csv')
gifted

# part a: compare mother's iq with child test score
plot(gifted$motheriq, gifted$score)
cor(gifted$motheriq, gifted$score)

# part b: same as a, but with father's iq
plot(gifted$fatheriq, gifted$score)
cor(gifted$fatheriq, gifted$score)

# part d: histogram of mother iq - father iq
iq.diffs <- gifted$motheriq - gifted$fatheriq
hist(iq.diffs, breaks = 10)

# part e: test and interval estimate for a difference
t.test(iq.diffs, alternative = 'greater', conf.level = 0.99)

# part f: test whether on average gifted children count to 10 before 2yrs
t.test(gifted$count, mu = 24, alternative = 'less')
```

### Problem 2: lizard running speeds

2. [L3, L4, L5] The dataset `lizards` contains running speeds measured in a laboratory race track for two species of lizards, Western Fence (WF) and Sagebrush (S) lizards. Speeds are recorded in meters per second. 

    a. [L3] Construct side-by-side boxplots of top speed by species. Comment on whether the assumptions for inference using the $t$ model seem appropriate.
    b. [L4] Compute point estimates and standard errors for the mean top speed for each species.
    c. [L4] Compute and interpret 99.5% confidence intervals for the mean top speed for each species. 
    d. [L4, L5] Test for a difference in mean top speed between species at the 1% significance level and provide an interval estimate at the appropriate confidence level. Interpret the test and estimate following the narrative style introduced in class. 

```{r lizards data}
lizards <- openintro::lizard_run |>
  mutate(species = factor(common_name, labels = c('western.fence', 'sagebrush'))) |>
  select(top_speed, species) |>
  rename(top.speed = top_speed)
save(lizards, file = 'data/lizards.RData')
``` 

```{r problem 2}
# part a: boxplots of top speed; assumptions for t model reasonable?
boxplot(top.speed ~ species, data = lizards, horizontal = T)

# part b: point estimates and standard errors for mean top speed by species
lizards |>
  group_by(species) |>
  summarize(mean = mean(top.speed),
            mean.se = sd(top.speed)/sqrt(n()),
            n = n()) 

# part c: 99.5% intervals for mean top speed for each species
lizards |>
  group_by(species) |>
  summarize(mean = mean(top.speed),
            mean.se = sd(top.speed)/sqrt(n()),
            lwr = mean - qt(0.9975, df = n() - 1)*mean.se,
            upr = mean + qt(0.9975, df = n() - 1)*mean.se) 

# part d: 
# test for a difference in means at the 1% significance level; 
# compute a 99% CI for the difference in means
rslt <- t.test(top.speed ~ species, data = lizards, conf.level = 0.99)
rslt
rslt$estimate |> diff()
rslt$stderr
```


### Problem 3: self- and cross-fertilization and plant vigor

3.  [L3, L4, L5] Does self-fertilization produce less vigorous plants than cross-fertilization? The dataset `plants` contains measurements of plant heights in inches for 15 pairs of plants of the same age; one plant in each pair was grown from a seed from a cross-fertilized flower, and the other was grown from a seed from a self-fertilized flower.

    a. [L3] Visualize the distribution of differences in plant heights between the cross-fertilized and self-fertilized individuals. Does the plot alone suggest an answer to the question of interest?
    b. [L4, L5] Test, at the 2% level, whether mean height of plants grown from cross-fertilized seeds exceeds that of plants grown from self-fertilized seeds and provide a confidence bound for the difference at the level corresponding to your test. Report the results of your analysis in context following the narrative style introduced in class.


```{r plants data}
plants <- Sleuth3::ex0428 |> rename_with(tolower) |>
  mutate(pair = row_number()) |>
  select(pair, cross, self)

write_csv(plants, file = 'data/plants.csv')
```

```{r problem 3}
# read in data
plants <- read_csv('data/plants.csv')
head(plants)

# compute pairwise differences
height.diffs <- plants$cross - plants$self

# part a: visualize distribution of differences
hist(height.diffs, breaks = 10)

# part b: test whether mean height for cross-fertilized exceeds that for self-fertilized at the 1% level and produce a confidence bound
t.test(height.diffs, alternative = 'greater', conf.level = 0.98)
```


### Problem 4: creativity and motivation

4. [L1, L2, L3, L4, L5] The `creativity` dataset contains data from an experiment on the effect of intrinsic vs. extrinsic motivation on creativity. A random sample of 47 creative writing students at an unnamed university were randomly assigned to one of two groups, extrinsic and intrinsic; each subject was instructed to write two short poems, but those in the extrinsic motivation group were primed on the task in a way that oriented them to external motivations for writing, and those in the intrinsic group were primed on the task in a way that oriented them to internal motivations for writing. Poems were scored by judges for creativity on a 40-point scale, and each subject received an average score. 

    a. [L1] What is the study population? Based on the study description, is the sample representative, and if so, why?
    b. [L2] What type of study is this? Based on the study description, can the data support causal inferences about motivation and creativity, and if so, why?
    c. [L3] Construct an appropriate graphical summary comparing the distributions of average scores by treatment group.
    d. [L4] Provide point estimates and standard errors for the mean creativity score in each group.
    e. [L5] Test the hypothesis that motivational framing has no effect on creativity at the 1% significance level. Compute an interval estimate for the difference in mean scores at the level corresponding to your test. Use your results from (c)-(d) to check assumptions. Write a short narrative summary of your results following the style introduced in class. (Don't forget to include a point estimate and standard error.)
    

```{r creativity data}
creativity <- Sleuth3::case0101 |>
  rename_with(tolower)

save(creativity, file = 'data/creativity.RData')
```

```{r problem 4}
# load dataset
load('data/creativity.RData')

# part c: graphic comparing scores between the two groups
boxplot(score ~ treatment, data = creativity, horizontal = T)

# part d: summary statistics for center, spread, and number of observations
creativity |>
  group_by(treatment) |>
  summarize(n.obs = n(),
            mean.score = mean(score),
            sd.score = sd(score),
            median.score = median(score),
            iqr.score = IQR(score),
            mean.se = sd.score/sqrt(n.obs))

# part e: test whether motivational framing has an effect on creativity at the 1% level and provide a CI for the difference in means
t.test(score ~ treatment, data = creativity, conf.level = 0.99)
```

































